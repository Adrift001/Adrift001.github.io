<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>servlet程序</title>
    <url>/servlet%E7%A8%8B%E5%BA%8F/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/random/1600x900"></p>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.swifter;</span><br><span class="line"></span><br><span class="line">import com.sun.net.httpserver.HttpExchange;</span><br><span class="line">import com.sun.net.httpserver.HttpHandler;</span><br><span class="line">import com.sun.net.httpserver.HttpServer;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.OutputStream;</span><br><span class="line">import java.net.InetSocketAddress;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public class Main &#123;</span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        Server server = new Server();</span><br><span class="line">        server.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Server &#123;</span><br><span class="line"></span><br><span class="line">    List &lt;Servlet&gt; servlets = new ArrayList();</span><br><span class="line"></span><br><span class="line">    void start() throws Exception &#123;</span><br><span class="line">        File file = new File(new String(this.getClass().getResource(&quot;./&quot;).getPath()));</span><br><span class="line">        System.out.println(file.getPath());</span><br><span class="line">        File[] files = file.listFiles();</span><br><span class="line">        if (files != null) &#123;</span><br><span class="line">            for (File f : files) &#123;</span><br><span class="line">                String fileName = f.getName();</span><br><span class="line">                fileName = fileName.substring(0,fileName.lastIndexOf(&quot;.&quot;));</span><br><span class="line">                if (!fileName.equals(&quot;Servlet&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">                    System.out.println(this.getClass().getPackage().getName() + &quot;.&quot;+fileName);</span><br><span class="line">                    Class&lt;Servlet&gt; aClass = (Class&lt;Servlet&gt;) Class.forName(this.getClass().getPackage().getName() + &quot;.&quot;+fileName);</span><br><span class="line">                    if (Servlet.class.isAssignableFrom(aClass)) &#123;</span><br><span class="line">                        servlets.add(aClass.newInstance());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            System.out.println(&quot;list is null&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        HttpServer httpServer = HttpServer.create(new InetSocketAddress(8080), 0);</span><br><span class="line"></span><br><span class="line">        for (Servlet servlet : servlets) &#123;</span><br><span class="line">            System.out.println(servlet.path());</span><br><span class="line">            httpServer.createContext(servlet.path(), new HttpHandler() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void handle(HttpExchange httpExchange) throws IOException &#123;</span><br><span class="line">                    servlet.service(httpExchange);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        httpServer.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Hello1Servlet implements Servlet &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String path() &#123;</span><br><span class="line">        return &quot;/hello1&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void service(HttpExchange exchange) throws IOException &#123;</span><br><span class="line">        exchange.sendResponseHeaders(200, 0);</span><br><span class="line">        OutputStream responseBody = exchange.getResponseBody();</span><br><span class="line">        responseBody.write(&quot;hello world1111&quot;.getBytes());</span><br><span class="line">        responseBody.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Hello2Servlet implements Servlet &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String path() &#123;</span><br><span class="line">        return &quot;/hello2&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void service(HttpExchange exchange) throws IOException &#123;</span><br><span class="line">        exchange.sendResponseHeaders(200, 0);</span><br><span class="line">        OutputStream responseBody = exchange.getResponseBody();</span><br><span class="line">        responseBody.write(&quot;hello world2222&quot;.getBytes());</span><br><span class="line">        responseBody.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface Servlet &#123;</span><br><span class="line">    public String path();</span><br><span class="line">    public void service(HttpExchange exchange) throws IOException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
  </entry>
  <entry>
    <title>Swift 5 字符串插值-AttributedStrings</title>
    <url>/ExpressibleByStringInterpolation/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/KYjsoR9MCRE/1600x900"></p>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// https://swift.gg/2019/10/18/swift5-stringinterpolation-part2/</span><br><span class="line">struct AttrString &#123;</span><br><span class="line">    let attributedString: NSAttributedString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension AttrString: ExpressibleByStringLiteral &#123;</span><br><span class="line">    init(stringLiteral: String) &#123;</span><br><span class="line">        self.attributedString = NSAttributedString(string: stringLiteral)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension AttrString: CustomStringConvertible &#123;</span><br><span class="line">    var description: String &#123;</span><br><span class="line">        return String(describing: self.attributedString)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension AttrString: ExpressibleByStringInterpolation &#123;</span><br><span class="line">  init(stringInterpolation: StringInterpolation) &#123;</span><br><span class="line">    self.attributedString = NSAttributedString(attributedString: stringInterpolation.attributedString)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  struct StringInterpolation: StringInterpolationProtocol &#123;</span><br><span class="line">    var attributedString: NSMutableAttributedString</span><br><span class="line"></span><br><span class="line">    init(literalCapacity: Int, interpolationCount: Int) &#123;</span><br><span class="line">      self.attributedString = NSMutableAttributedString()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func appendLiteral(_ literal: String) &#123;</span><br><span class="line">      let astr = NSAttributedString(string: literal)</span><br><span class="line">      self.attributedString.append(astr)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func appendInterpolation(_ string: String, attributes: [NSAttributedString.Key: Any]) &#123;</span><br><span class="line">      let astr = NSAttributedString(string: string, attributes: attributes)</span><br><span class="line">      self.attributedString.append(astr)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension AttrString &#123;</span><br><span class="line">    struct Style &#123;</span><br><span class="line">        let attributes: [NSAttributedString.Key: Any]</span><br><span class="line">        static func font(_ font: UIFont) -&gt; Style &#123;</span><br><span class="line">            return Style(attributes: [.font: font])</span><br><span class="line">        &#125;</span><br><span class="line">        static func color(_ color: UIColor) -&gt; Style &#123;</span><br><span class="line">            return Style(attributes: [.foregroundColor: color])</span><br><span class="line">        &#125;</span><br><span class="line">        static func bgColor(_ color: UIColor) -&gt; Style &#123;</span><br><span class="line">            return Style(attributes: [.backgroundColor: color])</span><br><span class="line">        &#125;</span><br><span class="line">        static func link(_ link: String) -&gt; Style &#123;</span><br><span class="line">            return .link(URL(string: link)!)</span><br><span class="line">        &#125;</span><br><span class="line">        static func link(_ link: URL) -&gt; Style &#123;</span><br><span class="line">            return Style(attributes: [.link: link])</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        static let oblique = Style(attributes: [.obliqueness: 0.1])</span><br><span class="line">        </span><br><span class="line">        static func underline(_ color: UIColor, _ style: NSUnderlineStyle) -&gt; Style &#123;</span><br><span class="line">            return Style(attributes: [</span><br><span class="line">                .underlineColor: color,</span><br><span class="line">                .underlineStyle: style.rawValue</span><br><span class="line">            ])</span><br><span class="line">        &#125;</span><br><span class="line">        static func alignment(_ alignment: NSTextAlignment) -&gt; Style &#123;</span><br><span class="line">            let ps = NSMutableParagraphStyle()</span><br><span class="line">            ps.alignment = alignment</span><br><span class="line">            return Style(attributes: [.paragraphStyle: ps])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension AttrString.StringInterpolation &#123;</span><br><span class="line">    func appendInterpolation(_ string: String, _ style: AttrString.Style...) &#123;</span><br><span class="line">        var attrs: [NSAttributedString.Key: Any] = [:]</span><br><span class="line">        style.forEach &#123; attrs.merge($0.attributes, uniquingKeysWith: &#123;$1&#125;) &#125;</span><br><span class="line">        let astr = NSAttributedString(string: string, attributes: attrs)</span><br><span class="line">        self.attributedString.append(astr)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension AttrString.StringInterpolation &#123;</span><br><span class="line">    func appendInterpolation(image: UIImage, scale: CGFloat = 1.0) &#123;</span><br><span class="line">        let attachment = NSTextAttachment()</span><br><span class="line">        if let cgImage = image.cgImage &#123;</span><br><span class="line">            attachment.image = UIImage(cgImage: cgImage, scale: scale, orientation: .left)</span><br><span class="line">            self.attributedString.append(NSAttributedString(attachment: attachment))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension AttrString.StringInterpolation &#123;</span><br><span class="line">    func appendInterpolation(wrap string: AttrString, _ style: AttrString.Style...) &#123;</span><br><span class="line">        var attrs: [NSAttributedString.Key: Any] = [:]</span><br><span class="line">        style.forEach &#123; attrs.merge($0.attributes, uniquingKeysWith: &#123;$1&#125;) &#125;</span><br><span class="line">        let mas = NSMutableAttributedString(attributedString: string.attributedString)</span><br><span class="line">        let fullRange = NSRange(mas.string.startIndex..&lt;mas.string.endIndex, in: mas.string)</span><br><span class="line">        mas.addAttributes(attrs, range: fullRange)</span><br><span class="line">        self.attributedString.append(mas)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://swift.gg/2019/10/18/swift5-stringinterpolation-part2/" target="_blank" rel="noopener">原文链接</a></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>RabbitMQ入门案例</title>
    <url>/springboot-rabbitmq/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/smVvkLmSxpk/1600x900"></p>
<a id="more"></a>

<h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Sender"><a href="#Sender" class="headerlink" title="Sender"></a>Sender</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 消息发送者</span><br><span class="line"> */</span><br><span class="line">@Component</span><br><span class="line">public class Sender &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AmqpTemplate rabbitAmqpTemplate;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 发送消息方法</span><br><span class="line">     */</span><br><span class="line">    public void send(String msg) &#123;</span><br><span class="line">        //向消息队列中发送消息</span><br><span class="line">        //参数一: 队列名称</span><br><span class="line">        //参数二: 消息</span><br><span class="line">        this.rabbitAmqpTemplate.convertAndSend(&quot;hello-queue&quot;, msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Receiver"><a href="#Receiver" class="headerlink" title="Receiver"></a>Receiver</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.swifter;</span><br><span class="line"></span><br><span class="line">import org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 消息接受者</span><br><span class="line"> */</span><br><span class="line">@Component</span><br><span class="line">public class Receiver &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 接收消息的方法, 采用消息队列监听机制</span><br><span class="line">     * @param msg</span><br><span class="line">     */</span><br><span class="line">    @RabbitListener(queues = &quot;hello-queue&quot;)</span><br><span class="line">    public void process(String msg) &#123;</span><br><span class="line">        System.out.println(&quot;receiver: &quot; + msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HelloController"><a href="#HelloController" class="headerlink" title="HelloController"></a>HelloController</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import com.swifter.Sender;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">public class HelloController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private Sender sender;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;quick&quot;)</span><br><span class="line">    public String quick() &#123;</span><br><span class="line">        sender.send(&quot;hello world&quot;);</span><br><span class="line">        return &quot;Hello world!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
  </entry>
  <entry>
    <title>SpringBoot集成MyBatis</title>
    <url>/springboot-mybatis/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/e384bP4Sieg/1600x900"></p>
<a id="more"></a>

<h3 id="添加mybatis起步依赖"><a href="#添加mybatis起步依赖" class="headerlink" title="添加mybatis起步依赖"></a>添加mybatis起步依赖</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.1.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="添加数据库坐标"><a href="#添加数据库坐标" class="headerlink" title="添加数据库坐标"></a>添加数据库坐标</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="添加数据库连接信息"><a href="#添加数据库连接信息" class="headerlink" title="添加数据库连接信息"></a>添加数据库连接信息</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 数据库连接信息</span><br><span class="line">spring.datasource.driverClassName=com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/eesy?useUnicode=true&amp;characterEncoding=utf8</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=jingxuetao</span><br></pre></td></tr></table></figure>

<h3 id="创建User表"><a href="#创建User表" class="headerlink" title="创建User表"></a>创建User表</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">DROP TABLE IF EXISTS `user`;</span><br><span class="line">CREATE TABLE `user` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `username` varchar(32) NOT NULL COMMENT &apos;用户名称&apos;,</span><br><span class="line">  `birthday` datetime DEFAULT NULL COMMENT &apos;生日&apos;,</span><br><span class="line">  `sex` char(1) DEFAULT NULL COMMENT &apos;性别&apos;,</span><br><span class="line">  `address` varchar(256) DEFAULT NULL COMMENT &apos;地址&apos;,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=49 DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of user</span><br><span class="line">-- ----------------------------</span><br><span class="line">BEGIN;</span><br><span class="line">INSERT INTO `user` VALUES (41, &apos;老王&apos;, &apos;2018-02-27 17:47:08&apos;, &apos;男&apos;, &apos;北京&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (42, &apos;小二王&apos;, &apos;2018-03-02 15:09:37&apos;, &apos;女&apos;, &apos;北京金燕龙&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (43, &apos;小二王&apos;, &apos;2018-03-04 11:34:34&apos;, &apos;女&apos;, &apos;北京金燕龙&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (45, &apos;传智播客&apos;, &apos;2018-03-04 12:04:06&apos;, &apos;男&apos;, &apos;北京金燕龙&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (46, &apos;老王&apos;, &apos;2018-03-07 17:37:26&apos;, &apos;男&apos;, &apos;北京&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (48, &apos;小马宝莉&apos;, &apos;2018-03-08 11:44:00&apos;, &apos;女&apos;, &apos;北京修正&apos;);</span><br><span class="line">COMMIT;</span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS = 1;</span><br></pre></td></tr></table></figure>

<h3 id="创建实体Bean"><a href="#创建实体Bean" class="headerlink" title="创建实体Bean"></a>创建实体Bean</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">    private Long id;</span><br><span class="line">    private String username;</span><br><span class="line">    private String password;</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public Long getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Long id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getUsername() &#123;</span><br><span class="line">        return username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUsername(String username) &#123;</span><br><span class="line">        this.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getPassword() &#123;</span><br><span class="line">        return password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setPassword(String password) &#123;</span><br><span class="line">        this.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;User&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, username=&apos;&quot; + username + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, password=&apos;&quot; + password + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="编写Mapper"><a href="#编写Mapper" class="headerlink" title="编写Mapper"></a>编写Mapper</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@Mapper</span><br><span class="line">public interface UserMapper &#123;</span><br><span class="line"></span><br><span class="line">    public List&lt;User&gt; queryUserList();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="配置Mapper映射文件"><a href="#配置Mapper映射文件" class="headerlink" title="配置Mapper映射文件"></a>配置Mapper映射文件</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.example.mapper.UserMapper&quot;&gt;</span><br><span class="line">    &lt;select id=&quot;queryUserList&quot; resultType=&quot;com.example.domain.User&quot;&gt;</span><br><span class="line">        select * from user</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

<h3 id="在application-properties中添加mybatis信息"><a href="#在application-properties中添加mybatis信息" class="headerlink" title="在application.properties中添加mybatis信息"></a>在application.properties中添加mybatis信息</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#配置mybatis信息</span><br><span class="line">#pojo包扫描</span><br><span class="line">mybatis.type-aliases-package=com.example.domain</span><br><span class="line">#映射文件mapper扫描</span><br><span class="line">mybatis.mapper-locations=classpath:mapper/*Mapper.xml</span><br></pre></td></tr></table></figure>

<h3 id="编写测试controller"><a href="#编写测试controller" class="headerlink" title="编写测试controller"></a>编写测试controller</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class TestControler &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;user&quot;)</span><br><span class="line">    public List&lt;User&gt; queryUserList() &#123;</span><br><span class="line">        List&lt;User&gt; users = userMapper.queryUserList();</span><br><span class="line">        return users;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
  </entry>
  <entry>
    <title>SpringBoot快速入门</title>
    <url>/springboot-start/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/V4aqnD38ND0/1600x900"></p>
<a id="more"></a>

<h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><p>pom.xml</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 所有的springboot工程都必须继承spring-boot-starter-parent --&gt;</span><br><span class="line">&lt;parent&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.1.9.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;!-- web功能 --&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>

<p>Application.java</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.swifter;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class Application &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.swifter.controller;</span><br><span class="line"></span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">public class HelloController &#123;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;quick&quot;)</span><br><span class="line">    public String quick() &#123;</span><br><span class="line">        return &quot;Hello world!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="SpringBoot热部署"><a href="#SpringBoot热部署" class="headerlink" title="SpringBoot热部署"></a>SpringBoot热部署</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 热部署 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p><img alt="image-20191206204647986" data-src="image-20191206204647986.png"></p>
<p>cmd+shift+a -&gt; Registry…</p>
<p><img alt="image-20191206204647986" data-src="%E6%88%AA%E5%B1%8F2019-12-06%E4%B8%8B%E5%8D%888.52.03.png"></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
  </entry>
  <entry>
    <title>MyBatis入门</title>
    <url>/mybatis-start/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/THvwPugg7CA/1600x900"></p>
<a id="more"></a>
<h3 id="mybatis环境搭建"><a href="#mybatis环境搭建" class="headerlink" title="mybatis环境搭建"></a>mybatis环境搭建</h3><ol>
<li>创建maven工程并导入坐标</li>
<li>创建实体类和dao接口</li>
<li>创建mybatis的主配置文件<code>SqlMapConfig.xml</code></li>
<li>创建映射配置文件<code>UserDao.xml</code></li>
</ol>
<h4 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── main</span><br><span class="line">│   ├── java</span><br><span class="line">│   │   └── com</span><br><span class="line">│   │       └── swifter</span><br><span class="line">│   │           ├── dao</span><br><span class="line">│   │           │   └── UserDao.java</span><br><span class="line">│   │           └── domain</span><br><span class="line">│   │               └── User.java</span><br><span class="line">│   └── resources</span><br><span class="line">│       ├── SqlMapConfig.xml</span><br><span class="line">│       ├── com</span><br><span class="line">│       │   └── swifter</span><br><span class="line">│       │       └── dao</span><br><span class="line">│       │           └── UserDao.xml</span><br><span class="line">│       └── log4j.properties</span><br><span class="line">└── test</span><br><span class="line">    └── java</span><br><span class="line">        └── com</span><br><span class="line">            └── swifter</span><br><span class="line">                └── test</span><br><span class="line">                    └── MybatisTest.java</span><br></pre></td></tr></table></figure>

<h4 id="User-java"><a href="#User-java" class="headerlink" title="User.java"></a>User.java</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", username='"</span> + username + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", birthday="</span> + birthday +</span><br><span class="line">                <span class="string">", sex='"</span> + sex + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", address='"</span> + address + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="UserDao-java"><a href="#UserDao-java" class="headerlink" title="UserDao.java"></a>UserDao.java</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有操作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="SqlMapConfig-xml"><a href="#SqlMapConfig-xml" class="headerlink" title="SqlMapConfig.xml"></a>SqlMapConfig.xml</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;!-- mybatis的主配置文件 --&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- 配置环境 --&gt;</span><br><span class="line">    &lt;environments default=&quot;mysql&quot;&gt;</span><br><span class="line">        &lt;!-- 配置mysql的环境--&gt;</span><br><span class="line">        &lt;environment id=&quot;mysql&quot;&gt;</span><br><span class="line">            &lt;!-- 配置事务的类型--&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;</span><br><span class="line">            &lt;!-- 配置数据源（连接池） --&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;!-- 配置连接数据库的4个基本信息 --&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/eesy?characterEncoding=utf-8&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;jingxuetao&quot;/&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 指定映射配置文件的位置，映射配置文件指的是每个dao独立的配置文件 --&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;com/swifter/dao/UserDao.xml&quot;/&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<h4 id="UserDao-xml"><a href="#UserDao-xml" class="headerlink" title="UserDao.xml"></a>UserDao.xml</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.swifter.dao.UserDao&quot;&gt;</span><br><span class="line">    &lt;!--配置查询所有--&gt;</span><br><span class="line">    &lt;select id=&quot;findAll&quot; resultType=&quot;com.swifter.domain.User&quot;&gt;</span><br><span class="line">        select * from user</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

<h4 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.swifter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis_01_start<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ol>
<li>创建UserDao.xml 和 UserDao.java时, 名称是为了和之前的知识保持一致,mybatis把持久层操作接口名称和映射文件(Mapper) UserMapper和UserDao 应该只是名称的区别</li>
<li>在idea中创建目录时和包不一样, 包创建com.swifter.dao是三级目录, 目录创建是一级目录.</li>
<li>mybatis映射配置文件必须和dao接口包结构相同</li>
<li>映射配置文件的mapper标签namespace属性取值,必须是dao接口的全限定类名.</li>
<li>映射配置文件的操作配置,id属性取值必须是dao接口的方法名.</li>
</ol>
<p>实现3, 4, 5后, 在开发中无需再写dao的实现类.</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>MyBatis</category>
      </categories>
  </entry>
  <entry>
    <title>指针</title>
    <url>/pointer/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/alamoUCs2FY/1600x900"></p>
<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/// Swift里面也有专门的指针类型,这些都被定性为 `Unsafe`(不安全的), 常见的4种类型</span><br><span class="line">/// UnsafePointer&lt;Pointee&gt; 类似于 const Pointee *</span><br><span class="line">/// UnsafeMutablePointer&lt;Pointee&gt; 类似于  Pointee *</span><br><span class="line">/// UnsafeRawPointer 类似于 const void * 指向类型不确定</span><br><span class="line">/// UnsafeMutableRawPointer 类似于 void * 指向类型不确定</span><br><span class="line"></span><br><span class="line">var age = 10</span><br><span class="line">func test1(_ ptr: UnsafeMutablePointer&lt;Int&gt;) &#123;// int *</span><br><span class="line">    ptr.pointee = 20</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func test2(_ ptr: UnsafePointer&lt;Int&gt;) &#123; // const int *</span><br><span class="line">    print(&quot;test2&quot;, ptr.pointee)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func test3(_ ptr: UnsafeRawPointer) &#123; // const void *</span><br><span class="line">    print(&quot;test3&quot;, ptr.load(as: Int.self))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func test4(_ ptr: UnsafeMutableRawPointer) &#123; // void *</span><br><span class="line">    ptr.storeBytes(of: 30, as: Int.self)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//func test3(_ num: inout Int) &#123;</span><br><span class="line">//</span><br><span class="line">//&#125;</span><br><span class="line"></span><br><span class="line">test1(&amp;age)</span><br><span class="line">test2(&amp;age)</span><br><span class="line">test3(&amp;age)</span><br><span class="line">test4(&amp;age)</span><br><span class="line">//test3(&amp;age)</span><br><span class="line">print(age)</span><br><span class="line"></span><br><span class="line">/// 使用场景</span><br><span class="line">/// OC -&gt; BOOL *</span><br><span class="line">/// Swift -&gt; UnsafeMutablePointer&lt;ObjeCBool&gt;</span><br><span class="line">var arr = NSArray(objects: 11, 22, 33, 44)</span><br><span class="line">arr.enumerateObjects &#123; (element, idx, stop) in</span><br><span class="line">    if idx == 2 &#123;</span><br><span class="line">        stop.pointee = true</span><br><span class="line">    &#125;</span><br><span class="line">    print(idx, element)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// 获得指向某个变量的指针</span><br><span class="line">/// withUnsafePointer 跟body返回类型一样</span><br><span class="line">var ptrAge1 = withUnsafePointer(to: &amp;age)&#123; $0 &#125;</span><br><span class="line">print(ptrAge1.pointee)</span><br><span class="line">var ptrAge2 = withUnsafeMutablePointer(to: &amp;age) &#123; (pointer) -&gt; UnsafeMutablePointer&lt;Int&gt; in</span><br><span class="line">    return pointer</span><br><span class="line">&#125;</span><br><span class="line">var ptrAge3 = withUnsafePointer(to: &amp;age, &#123; UnsafeRawPointer($0) &#125;)</span><br><span class="line">var ptrAge4 = withUnsafeMutablePointer(to: &amp;age, &#123; UnsafeMutableRawPointer($0) &#125;)</span><br><span class="line">ptrAge4.storeBytes(of: 40, as: Int.self)</span><br><span class="line">print(age)</span><br><span class="line"></span><br><span class="line">/// 获取指向堆空间的指针</span><br><span class="line">class Person &#123;</span><br><span class="line">    var age = 0</span><br><span class="line">    deinit &#123;</span><br><span class="line">        print(&quot;Person deinit&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">var person = Person()</span><br><span class="line">var ptrPerson1 = withUnsafePointer(to: &amp;person, &#123; $0 &#125;) //保存person对象的地址值</span><br><span class="line">print(ptrPerson1.pointee.age)</span><br><span class="line"></span><br><span class="line">/// 创建指针</span><br><span class="line">var mPtr = malloc(16)</span><br><span class="line">mPtr?.storeBytes(of: 11, as: Int.self)</span><br><span class="line">mPtr?.storeBytes(of: 22, toByteOffset: 8, as: Int.self)</span><br><span class="line">print(mPtr?.load(as: Int.self))</span><br><span class="line">print(mPtr?.load(fromByteOffset: 8, as: Int.self))</span><br><span class="line">free(mPtr)</span><br><span class="line"></span><br><span class="line">var allPtr = UnsafeMutableRawPointer.allocate(byteCount: 16, alignment: 1)</span><br><span class="line">allPtr.storeBytes(of: 11, as: Int.self)</span><br><span class="line">allPtr.storeBytes(of: 22, toByteOffset: 8, as: Int.self)</span><br><span class="line">allPtr.advanced(by: 8) //移动8个字节,返回一个新指针</span><br><span class="line">allPtr.deallocate()</span><br><span class="line"></span><br><span class="line">var capPtr = UnsafeMutablePointer&lt;Int&gt;.allocate(capacity: 3)</span><br><span class="line">capPtr.initialize(to: 11)</span><br><span class="line">capPtr.successor().initialize(to: 22)</span><br><span class="line">capPtr.successor().successor().initialize(to: 33)</span><br><span class="line">print(capPtr.pointee)</span><br><span class="line">print((capPtr + 1).pointee)</span><br><span class="line">print((capPtr + 2).pointee)</span><br><span class="line"></span><br><span class="line">print(capPtr[0])</span><br><span class="line">print(capPtr[1])</span><br><span class="line">print(capPtr[2])</span><br><span class="line">capPtr.deinitialize(count: 3)</span><br><span class="line">capPtr.deallocate()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var pPtr = UnsafeMutablePointer&lt;Person&gt;.allocate(capacity: 3)</span><br><span class="line">pPtr.initialize(to: Person())</span><br><span class="line">(pPtr + 1).initialize(to: Person())</span><br><span class="line">(pPtr + 2).initialize(to: Person())</span><br><span class="line">pPtr.deinitialize(count: 3)</span><br><span class="line">pPtr.deallocate()</span><br></pre></td></tr></table></figure>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>柯里化</title>
    <url>/currying/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/tJWZ3L9WLnE/1600x900"></p>
<blockquote class="blockquote-center">
柯里化
</blockquote>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import Foundation</span><br><span class="line"></span><br><span class="line">/// 柯里化</span><br><span class="line">/// 将一个接收多参数的函数变换为一系列只接收一个单个参数的函数</span><br><span class="line"></span><br><span class="line">func add1(_ v1: Int, _ v2: Int) -&gt; Int &#123;</span><br><span class="line">    return v1 + v2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func add(_ v: Int) -&gt; (Int) -&gt; Int &#123;</span><br><span class="line">    &#123; $0 + v &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let result1 = add1(10, 20)</span><br><span class="line">let result2 = add(20)(10)</span><br><span class="line">print(result1)</span><br><span class="line">print(result2)</span><br><span class="line"></span><br><span class="line">func add(_ v1: Int, _ v2: Int, _ v3: Int) -&gt; Int &#123;</span><br><span class="line">    return v1 + v2 + v3</span><br><span class="line">&#125;</span><br><span class="line">//                      v2        v1     result</span><br><span class="line">func add2(_ v3: Int) -&gt; (Int) -&gt; (Int) -&gt; Int &#123;</span><br><span class="line">//func add(_ v3: Int) -&gt; ((Int) -&gt; ((Int) -&gt; Int)) &#123;</span><br><span class="line">    // 20</span><br><span class="line">    return &#123; v2 in</span><br><span class="line">        // 10</span><br><span class="line">        return &#123; v1 in</span><br><span class="line">            return v1 + v2 + v3</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let result3 = add(10, 20, 30)</span><br><span class="line">let result4 = add2(30)(20)(10)</span><br><span class="line">print(result3)</span><br><span class="line">print(result4)</span><br><span class="line">/// 不断地函数嵌套, 最里层做计算</span><br><span class="line"></span><br><span class="line">func currying&lt;A, B, C&gt;(_ fn: @escaping (A, B) -&gt; C) -&gt; (B) -&gt; (A) -&gt; C &#123;</span><br><span class="line">    return &#123; b in</span><br><span class="line">        return &#123; a in</span><br><span class="line">            return fn(a, b)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">let result5 = currying(add1)(20)(10)</span><br><span class="line">print(result5)</span><br></pre></td></tr></table></figure>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>泛型</title>
    <url>/generic/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/KZIT2OYws-s/1600x900"></p>
<blockquote class="blockquote-center">
Swift泛型
</blockquote>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/// 泛型函数</span><br><span class="line">var n1 = 10</span><br><span class="line">var n2 = 20</span><br><span class="line">func swapValues&lt;T&gt;(_ a: inout T, _ b: inout T) &#123;</span><br><span class="line">    (a, b) = (b, a)</span><br><span class="line">&#125;</span><br><span class="line">swapValues(&amp;n1, &amp;n2)</span><br><span class="line">print(n1)</span><br><span class="line">print(n2)</span><br><span class="line"></span><br><span class="line">/// 泛型函数赋值给变量</span><br><span class="line">var fn: (inout Int, inout Int) -&gt; () = swapValues</span><br><span class="line"></span><br><span class="line">/// 泛型类型</span><br><span class="line">class Stack&lt;E&gt; &#123;</span><br><span class="line">    var elements: [E] = []</span><br><span class="line">    </span><br><span class="line">    init(firstElement: E) &#123;</span><br><span class="line">        elements.append(firstElement)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func push(_ element: E) &#123;</span><br><span class="line">        elements.append(element)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func pop() -&gt; E &#123;</span><br><span class="line">        return elements.removeLast()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func top() -&gt; E? &#123;</span><br><span class="line">        return elements.last</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func size() -&gt; Int &#123;</span><br><span class="line">        return elements.count</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var intStack = Stack(firstElement: 10)</span><br><span class="line">//var intStack = Stack&lt;Int&gt;()</span><br><span class="line">//var stringStack = Stack&lt;String&gt;()</span><br><span class="line">//var anyStack = Stack&lt;Any&gt;()</span><br><span class="line"></span><br><span class="line">/// 泛型继承</span><br><span class="line">class SubStack&lt;E&gt;: Stack&lt;E&gt; &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// 泛型结构体</span><br><span class="line">struct StackStruct&lt;E&gt; &#123;</span><br><span class="line">    var elements: [E] = []</span><br><span class="line">    </span><br><span class="line">    mutating func push(_ element: E) &#123;</span><br><span class="line">        elements.append(element)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    mutating func pop() -&gt; E &#123;</span><br><span class="line">        return elements.removeLast()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func top() -&gt; E? &#123;</span><br><span class="line">        return elements.last</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func size() -&gt; Int &#123;</span><br><span class="line">        return elements.count</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// 泛型枚举</span><br><span class="line">enum Score&lt;T&gt; &#123;</span><br><span class="line">    case point(T)</span><br><span class="line">    case grade(String)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let score0 = Score&lt;Int&gt;.point(10)</span><br><span class="line">let score1 = Score.point(10.0)</span><br><span class="line">let score2 = Score&lt;Int&gt;.grade(&quot;A&quot;)</span><br><span class="line"></span><br><span class="line">/// 泛型本质, 根据类型元信息操作</span><br><span class="line"></span><br><span class="line">/// 关联类型</span><br><span class="line">/// 作用: 给协议中用到的类型定义一个占位名称</span><br><span class="line">/// 协议可以有多个关联类型</span><br><span class="line">protocol Stackable &#123;</span><br><span class="line">    associatedtype Element</span><br><span class="line">    mutating func push(_ element: Element)</span><br><span class="line">    mutating func pop() -&gt; Element</span><br><span class="line">    func top() -&gt; Element?</span><br><span class="line">    func size() -&gt; Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class StringStack: Stackable &#123;</span><br><span class="line">    var elements: [String] = []</span><br><span class="line">    </span><br><span class="line">    func push(_ element: String) &#123;</span><br><span class="line">        elements.append(element)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func pop() -&gt; String &#123;</span><br><span class="line">        return elements.removeLast()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func top() -&gt; String? &#123;</span><br><span class="line">        return elements.last</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func size() -&gt; Int &#123;</span><br><span class="line">        return elements.count</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// 类型约束</span><br><span class="line">protocol Runnable &#123;  &#125;</span><br><span class="line">class Person &#123;  &#125;</span><br><span class="line">func swapValues&lt;T: Person &amp; Runnable&gt;(_ a: inout T, _ b: inout T) &#123;</span><br><span class="line">    (a, b) = (b, a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">protocol Stackable1 &#123;</span><br><span class="line">    associatedtype Element: Equatable</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Stack1&lt;E: Equatable&gt;: Stackable1 &#123;</span><br><span class="line">    typealias Element = E</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func equal&lt;S1: Stackable1, S2: Stackable1&gt;(_ s1: S1, _ s2: S2) -&gt; Bool where S1.Element == S2.Element, S1.Element: Hashable &#123;</span><br><span class="line">    return false</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var s1 = Stack1&lt;Int&gt;()</span><br><span class="line">var s2 = Stack1&lt;Int&gt;()</span><br><span class="line">var s3 = Stack1&lt;String&gt;()</span><br><span class="line"></span><br><span class="line">equal(s1, s2)</span><br><span class="line">//equal(s1, s3) //error, S1.Element == S2.Element</span><br><span class="line"></span><br><span class="line">/// 协议类型注意点</span><br><span class="line">protocol Runnable1 &#123;</span><br><span class="line">    associatedtype Speed</span><br><span class="line">    var speed: Speed &#123; get &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Person1: Runnable1 &#123;</span><br><span class="line">    var speed: Double &#123;</span><br><span class="line">        return 0.0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Car1: Runnable1 &#123;</span><br><span class="line">    var speed: Int &#123;</span><br><span class="line">        return 0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//func get(_ type: Int) -&gt; Runnable1 &#123;</span><br><span class="line">//    if type == 0 &#123;</span><br><span class="line">//        return Person1()</span><br><span class="line">//    &#125; else &#123;</span><br><span class="line">//        return Car1()</span><br><span class="line">//    &#125;</span><br><span class="line">//&#125;</span><br><span class="line"></span><br><span class="line">func get(_ type: Int) -&gt; some Runnable1 &#123;</span><br><span class="line">    return Car1()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var r1 = get(0) //Runnable1</span><br><span class="line">var r2 = get(1) //Runnable1</span><br><span class="line"></span><br><span class="line">/// 不透明类型的限制 (带有关联类型的协议)</span><br><span class="line">/// 1. 只能返回一种明确类型, 这样才能确定关联类型</span><br><span class="line">/// 2. some Runnable1 屏蔽一些内部实现细节, 只让外界知道是Runnable1</span><br></pre></td></tr></table></figure>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>避免强转</title>
    <url>/avoid-force-exchange/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/w24KoifPovw/1600x900"></p>
<blockquote class="blockquote-center">
总得说点什么,🙂
</blockquote>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import Foundation</span><br><span class="line"></span><br><span class="line">class Person &#123;</span><br><span class="line">    var name = &quot;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Teacher: Person &#123;</span><br><span class="line">    var age = 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let teacher: Person = Teacher()</span><br><span class="line"></span><br><span class="line">// 强转使用</span><br><span class="line">let age = (teacher as! Teacher).age</span><br><span class="line"></span><br><span class="line">// 避免强转</span><br><span class="line">if let tea = Optional(teacher) as? Teacher &#123;</span><br><span class="line">    print(tea.age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>茧</title>
    <url>/jian/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/62ORJJmEP_Y/1600x900"></p>
<blockquote class="blockquote-center">
总得说点什么
</blockquote>

<a id="more"></a>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=477817446&auto=0&height=66"></iframe>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Music</category>
      </categories>
  </entry>
  <entry>
    <title>Illusionary-Daytime</title>
    <url>/Illusionary-Daytime/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/vRyFSqEOTZI/1600x900"></p>
<blockquote class="blockquote-center">
不能断更,需要翻墙...
</blockquote>
<a id="more"></a>

<iframe width="560" height="315" src="https://www.youtube.com/embed/NOw2_7ge_Hs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Music</category>
      </categories>
  </entry>
  <entry>
    <title>UserDefaultsWrapper</title>
    <url>/userdefaults-wrapper/</url>
    <content><![CDATA[<p><img alt data-src="https://source.unsplash.com/R1Ku62Z7zqE/1600x900"></p>
<blockquote class="blockquote-center">
又水一篇...
</blockquote>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import HandyJSON</span><br><span class="line"></span><br><span class="line">extension Bool: HandyJSON &#123;  &#125;</span><br><span class="line">extension String: HandyJSON &#123;  &#125;</span><br><span class="line">extension Int: HandyJSON &#123;  &#125;</span><br><span class="line"></span><br><span class="line">enum UserDefaultsWrapperKey &#123;</span><br><span class="line">    case base(String)</span><br><span class="line">    case handyJSON(String)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@propertyWrapper</span><br><span class="line">struct UserDefaultsWrapper&lt;T: HandyJSON&gt; &#123;</span><br><span class="line">    let key: UserDefaultsWrapperKey</span><br><span class="line">    let defaultValue: T</span><br><span class="line">    init(key: UserDefaultsWrapperKey, defaultValue: T) &#123;</span><br><span class="line">        self.key = key</span><br><span class="line">        self.defaultValue = defaultValue</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var wrappedValue: T &#123;</span><br><span class="line">        get &#123;</span><br><span class="line">            switch key &#123;</span><br><span class="line">            case .base(let keyString):</span><br><span class="line">                return UserDefaults.standard.value(forKey: keyString) as? T ?? defaultValue</span><br><span class="line">            case .handyJSON(let keyString):</span><br><span class="line">                if let string = UserDefaults.standard.value(forKey: keyString) as? String, let object = T.deserialize(from: string) &#123;</span><br><span class="line">                    return object</span><br><span class="line">                &#125;</span><br><span class="line">                return defaultValue</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        set &#123;</span><br><span class="line">            switch key &#123;</span><br><span class="line">            case .base(let keyString):</span><br><span class="line">                UserDefaults.standard.set(newValue, forKey: keyString)</span><br><span class="line">            case .handyJSON(let keyString):</span><br><span class="line">                UserDefaults.standard.set(newValue.toJSONString() ?? &quot;&quot;, forKey: keyString)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>Moya-HandyJSON</title>
    <url>/moya-handyjson/</url>
    <content><![CDATA[<img data-src="/moya-handyjson/julia-caesar-DpoMKEARZe4-unsplash.jpg">

<blockquote class="blockquote-center">
水一篇,好像以前不水一样...
</blockquote>
<a id="more"></a>

<p>Response+HandyJSON.swift</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import Foundation</span><br><span class="line">import Moya</span><br><span class="line">import HandyJSON</span><br><span class="line"></span><br><span class="line">public extension Response &#123;</span><br><span class="line">    func mapObject&lt;T: HandyJSON&gt;(_ type: T.Type) throws -&gt; T &#123;</span><br><span class="line">        //判断code</span><br><span class="line">        guard let json = try mapJSON() as? [String: Any], let object = T.deserialize(from: json) else &#123;</span><br><span class="line">            throw MoyaError.jsonMapping(self)</span><br><span class="line">        &#125;</span><br><span class="line">        return object</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Single+HandyJSON.swift</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import Foundation</span><br><span class="line">import RxSwift</span><br><span class="line">import Moya</span><br><span class="line">import HandyJSON</span><br><span class="line"></span><br><span class="line">public extension PrimitiveSequence where TraitType == SingleTrait, ElementType == Response &#123;</span><br><span class="line">    </span><br><span class="line">    func mapObject&lt;T: HandyJSON&gt;(_ type: T.Type) -&gt; Single&lt;T&gt; &#123;</span><br><span class="line">        return flatMap &#123;</span><br><span class="line">            .just(try $0.mapObject(type))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/Adrift001/Moya-HandyJSON" target="_blank" rel="noopener">Moya-HandyJSON</a></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>逆波兰表达式求值</title>
    <url>/ni-bo-lan-biao-da-shi-qiu-zhi/</url>
    <content><![CDATA[<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// 计算逆波兰表达式</span><br><span class="line">class Solution &#123;</span><br><span class="line">    func evalRPN(_ tokens: [String]) -&gt; Int &#123;</span><br><span class="line">        </span><br><span class="line">        var stack: [Int] = []</span><br><span class="line">        for token in tokens &#123;</span><br><span class="line">            if isOperator(token: token) &#123;</span><br><span class="line">                let right = stack.popLast()!</span><br><span class="line">                let left = stack.popLast()!</span><br><span class="line">                let result = calculate(right: right, left: left, token: token)</span><br><span class="line">                stack.append(result)</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                stack.append(Int(token)!)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return stack.first!</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func calculate(right: Int, left: Int, token: String) -&gt; Int &#123;</span><br><span class="line">        if token == &quot;+&quot; &#123;</span><br><span class="line">            return left + right</span><br><span class="line">        &#125; else if token == &quot;-&quot; &#123;</span><br><span class="line">            return left - right</span><br><span class="line">        &#125; else if token == &quot;*&quot; &#123;</span><br><span class="line">            return left * right</span><br><span class="line">        &#125; else if token == &quot;/&quot; &#123;</span><br><span class="line">            return left / right</span><br><span class="line">        &#125;</span><br><span class="line">        return 0</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func isOperator(token: String) -&gt; Bool &#123;</span><br><span class="line">        return token == &quot;+&quot; || token == &quot;-&quot; || token == &quot;*&quot; || token == &quot;/&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let solution = Solution()</span><br><span class="line">let array = [&quot;-78&quot;,&quot;-33&quot;,&quot;196&quot;,&quot;+&quot;,&quot;-19&quot;,&quot;-&quot;,&quot;115&quot;,&quot;+&quot;,&quot;-&quot;,&quot;-99&quot;,&quot;/&quot;,&quot;-18&quot;,&quot;8&quot;,&quot;*&quot;,&quot;-86&quot;,&quot;-&quot;,&quot;-&quot;,&quot;16&quot;,&quot;/&quot;,&quot;26&quot;,&quot;-14&quot;,&quot;-&quot;,&quot;-&quot;,&quot;47&quot;,&quot;-&quot;,&quot;101&quot;,&quot;-&quot;,&quot;163&quot;,&quot;*&quot;,&quot;143&quot;,&quot;-&quot;,&quot;0&quot;,&quot;-&quot;,&quot;171&quot;,&quot;+&quot;,&quot;120&quot;,&quot;*&quot;,&quot;-60&quot;,&quot;+&quot;,&quot;156&quot;,&quot;/&quot;,&quot;173&quot;,&quot;/&quot;,&quot;-24&quot;,&quot;11&quot;,&quot;+&quot;,&quot;21&quot;,&quot;/&quot;,&quot;*&quot;,&quot;44&quot;,&quot;*&quot;,&quot;180&quot;,&quot;70&quot;,&quot;-40&quot;,&quot;-&quot;,&quot;*&quot;,&quot;86&quot;,&quot;132&quot;,&quot;-84&quot;,&quot;+&quot;,&quot;*&quot;,&quot;-&quot;,&quot;38&quot;,&quot;/&quot;,&quot;/&quot;,&quot;21&quot;,&quot;28&quot;,&quot;/&quot;,&quot;+&quot;,&quot;83&quot;,&quot;/&quot;,&quot;-31&quot;,&quot;156&quot;,&quot;-&quot;,&quot;+&quot;,&quot;28&quot;,&quot;/&quot;,&quot;95&quot;,&quot;-&quot;,&quot;120&quot;,&quot;+&quot;,&quot;8&quot;,&quot;*&quot;,&quot;90&quot;,&quot;-&quot;,&quot;-94&quot;,&quot;*&quot;,&quot;-73&quot;,&quot;/&quot;,&quot;-62&quot;,&quot;/&quot;,&quot;93&quot;,&quot;*&quot;,&quot;196&quot;,&quot;-&quot;,&quot;-59&quot;,&quot;+&quot;,&quot;187&quot;,&quot;-&quot;,&quot;143&quot;,&quot;/&quot;,&quot;-79&quot;,&quot;-89&quot;,&quot;+&quot;,&quot;-&quot;]</span><br><span class="line">let result = solution.evalRPN(array)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Algorithm</category>
      </categories>
  </entry>
  <entry>
    <title>协议前缀</title>
    <url>/protocol-prefix/</url>
    <content><![CDATA[<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import Foundation</span><br><span class="line"></span><br><span class="line">/// 前缀类型</span><br><span class="line">//前缀类型</span><br><span class="line">struct Swifter&lt;Base&gt; &#123;</span><br><span class="line">    let base: Base</span><br><span class="line">    init(_ base: Base) &#123;</span><br><span class="line">        self.base = base</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//利用协议扩展属性</span><br><span class="line">protocol SwifterProtocol &#123;&#125;</span><br><span class="line"></span><br><span class="line">extension SwifterProtocol &#123;</span><br><span class="line">    var swifter: Swifter&lt;Self&gt; &#123;</span><br><span class="line">        set &#123; &#125;</span><br><span class="line">        get &#123;</span><br><span class="line">            return Swifter(self)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    static var swifter: Swifter&lt;Self&gt;.Type &#123;</span><br><span class="line">        set &#123; &#125;</span><br><span class="line">        get &#123; Swifter&lt;Self&gt;.self &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//给字符串扩展功能</span><br><span class="line">extension String: SwifterProtocol &#123;&#125;</span><br><span class="line">extension NSString: SwifterProtocol &#123;&#125;</span><br><span class="line">//extension NSMutableString: SwifterProtocol &#123;&#125;</span><br><span class="line">//给Person扩展功能</span><br><span class="line">class Person&#123;&#125;</span><br><span class="line">extension Person: SwifterProtocol &#123;&#125;</span><br><span class="line"></span><br><span class="line">// 扩展功能</span><br><span class="line">extension Swifter where Base: ExpressibleByStringLiteral &#123;</span><br><span class="line">    var numberCount: Int &#123;</span><br><span class="line">        var count = 0</span><br><span class="line">        for c in (base as! String) where (&quot;0&quot;...&quot;9&quot;).contains(c) &#123;</span><br><span class="line">            count += 1</span><br><span class="line">        &#125;</span><br><span class="line">        return count</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    static func test() &#123;</span><br><span class="line">        print(&quot;test&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    mutating func run() &#123;</span><br><span class="line">// self.base = &quot;run&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension Swifter where Base: Person &#123;</span><br><span class="line">    func run() &#123;</span><br><span class="line">        print(&quot;跑&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print(&quot;123ooo123&quot;.swifter.numberCount)</span><br><span class="line">Person().swifter.run()</span><br><span class="line"></span><br><span class="line">String.swifter.test()</span><br><span class="line"></span><br><span class="line">var abc = &quot;123&quot;</span><br><span class="line">var def: NSMutableString = &quot;456&quot;</span><br><span class="line">abc.swifter.run()</span><br><span class="line">print(abc)</span><br><span class="line">def.swifter.run()</span><br><span class="line"></span><br><span class="line">/////////////////////////</span><br><span class="line"></span><br><span class="line">protocol ArrayType &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">extension Array: ArrayType&#123;&#125;</span><br><span class="line">extension NSArray: ArrayType&#123;&#125;</span><br><span class="line">extension String: ArrayType&#123;&#125;</span><br><span class="line">func isArrayType(_ type: Any.Type) -&gt; Bool &#123;</span><br><span class="line">    type is ArrayType.Type</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print(isArrayType([Int].self))</span><br><span class="line">print(isArrayType([Any].self))</span><br><span class="line">print(isArrayType(NSArray.self))</span><br><span class="line">print(isArrayType(NSMutableArray.self))</span><br><span class="line">print(isArrayType(String.self))</span><br></pre></td></tr></table></figure>
<p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>Vapor最简单的服务器</title>
    <url>/vapor-simplest-server/</url>
    <content><![CDATA[<h4 id="Package-swift"><a href="#Package-swift" class="headerlink" title="Package.swift"></a>Package.swift</h4><pre><code>// swift-tools-version:5.1
// The swift-tools-version declares the minimum version of Swift required to build this package.

import PackageDescription

let package = Package(
    name: &quot;HelloWorld&quot;,
    dependencies: [
        // Dependencies declare other packages that this package depends on.
         .package(url: &quot;https://github.com/vapor/vapor.git&quot;, from: &quot;4.0.0-alpha.2&quot;),
    ],
    targets: [
        // Targets are the basic building blocks of a package. A target can define a module or a test suite.
        // Targets can depend on other targets in this package, and on products in packages which this package depends on.
        .target(
            name: &quot;HelloWorld&quot;,
            dependencies: [&quot;Vapor&quot;]),
        .testTarget(
            name: &quot;HelloWorldTests&quot;,
            dependencies: [&quot;HelloWorld&quot;]),
    ]
)</code></pre><h4 id="main-swift"><a href="#main-swift" class="headerlink" title="main.swift"></a>main.swift</h4><pre><code>import Vapor

let app = Application(environment: try .detect()) { (service) in
    service.extend(Routes.self) { (routes, container) in
        routes.get(&quot;hello&quot;) { (req) -&gt; String in
            &quot;Hello World!&quot;
        }
    }
}
try app.run()</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Vapor</category>
      </categories>
  </entry>
  <entry>
    <title>Swift实现可选协议</title>
    <url>/swift-implements-optional-protocol/</url>
    <content><![CDATA[<h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h4><pre><code>protocol Runnable1: class { }

extension Runnable1 {
    func run() {

    }
}</code></pre><h4 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h4><pre><code>@objc protocol Runnable2 {
    @objc optional func run()
    func stop()
}</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>Swift 属性绑定</title>
    <url>/swift-property-binding/</url>
    <content><![CDATA[<pre><code>class Person { }

extension Person {

    private static var age_key = false //占一个字节,省空间
    private static var weight_key = false //占一个字节,省空间

// private static var age_key1: Void? //这种方式也是可以的
// private static var weight_key1: Void?

    var age: Int {
        get {
            objc_getAssociatedObject(self, &amp;Self.age_key) as! Int
        }
        set {
// self abc 都相当于是key
            objc_setAssociatedObject(self, &amp;Self.age_key, newValue, objc_AssociationPolicy.OBJC_ASSOCIATION_ASSIGN)
        }
    }

    var weight: Int {
        get {
            objc_getAssociatedObject(self, &amp;Self.weight_key) as! Int
        }
        set {
// self abc 都相当于是key
            objc_setAssociatedObject(self, &amp;Self.weight_key, newValue, objc_AssociationPolicy.OBJC_ASSOCIATION_ASSIGN)
        }
    }
}

var p = Person()
p.age = 10
print(p.age)
p.weight = 50
print(p.weight)</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>Swift重命名C函数</title>
    <url>/swift-renames-c-functions/</url>
    <content><![CDATA[<p> <strong>Test.h</strong></p>
<pre><code>#ifndef Test_h
#define Test_h

#include &lt;stdio.h&gt;
int sum(int v1, int v2);
#endif /* Test_h */</code></pre><p><strong>Test.c</strong></p>
<pre><code>#include &quot;Test.h&quot;

int sum(int v1, int v2) {
    return v1 + v2;
}</code></pre><p><strong>main.swift</strong></p>
<pre><code>// 重命名c函数
@_silgen_name(&quot;sum&quot;)
func swift_sum(_ v1: Int32, _ v2: Int32) -&gt; Int32

print(swift_sum(1, 2))</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>Custom expression pattern</title>
    <url>/custom-expression-pattern/</url>
    <content><![CDATA[<pre><code>// 自定义表达式模式
struct Student {
    var score = 0, name = &quot;&quot;

    /// pattern: case 后面内容
    /// value: switch 后面内容
    static func ~=(pattern: Int, value: Student) -&gt; Bool {
        return value.score &gt;= pattern
    }

    static func ~=(pattern: Range&lt;Int&gt;, value: Student) -&gt; Bool {
        return pattern.contains(value.score)
    }

    static func ~=(pattern: ClosedRange&lt;Int&gt;, value: Student) -&gt; Bool {
        return pattern.contains(value.score)
    }
}

var stu = Student(score: 75, name: &quot;Tom&quot;)
switch stu {
case 100:
    print(&quot;&gt;=100&quot;)
case 90:
    print(&quot;&gt;=90&quot;)
case 80..&lt;90:
    print(&quot;[80, 90]&quot;)
case 60...79:
    print(&quot;[60, 79]&quot;)
case 0:
    print(&quot;&gt;=0&quot;)
default:
    break
}

extension String {
    static func ~=(pattern: (String) -&gt; String, value: String) -&gt; Bool {
        return pattern(value)
    }
}

func hasPrefix(_ prefix: String) -&gt; ((String) -&gt; Bool) {
    return { $0.hasPrefix(prefix) }
}
func hasSuffix(_ suffix: String) -&gt; ((String) -&gt; Bool) {
    return { $0.hasSuffix(suffix) }
}

var fn = hasPrefix(&quot;123&quot;)
print(fn(&quot;123456&quot;))

var str = &quot;123456&quot;
switch str {
case hasPrefix(&quot;123&quot;), hasSuffix(&quot;456&quot;):
    print(&quot;123开头&quot;)
    print(&quot;456结尾&quot;)
default:
    break
}

func isEven(_ i: Int) -&gt; Bool {
    return i % 2 == 0
}

func isOdd(_ i: Int) -&gt; Bool {
    return i % 2 != 0
}

extension Int {
    static func ~=(pattern: (Int) -&gt; Bool, value: Int) -&gt; Bool {
        return pattern(value)
    }
}

var age = 9
switch age {
case isEven: //函数匹配,函数类型
    print(age,&quot;是个偶数&quot;)
case isOdd:
    print(age,&quot;是个奇数&quot;)
default:
    break
}</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>查找表</title>
    <url>/lookup-table/</url>
    <content><![CDATA[<p> <strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Algorithm</category>
      </categories>
  </entry>
  <entry>
    <title>Swift Access Control</title>
    <url>/swift-access-control/</url>
    <content><![CDATA[<ol>
<li>open: 允许在定义实体的模块,其他模块中访问,允许其他模块进行继承,重写(open只能用在类,类成员上)</li>
<li>public: 允许在定义实体的模块,其他模块中访问,不允许继承,重写(模块内可以)</li>
<li>internal: 只允许在定义实体的模块中访问,不允许在其他模块中访问(默认)</li>
<li>fileprivate: 在同一文件中访问</li>
<li>private: 在实体内访问</li>
</ol>
<blockquote>
<p>全局内用private修饰类,变量或扩展,就是用fileprivate</p>
</blockquote>
<pre><code>class Test {
    private struct Dog {
        var age = 0 //Test内可用,如果显式用private修饰,则Person内不能使用age
        func run() { }
    }

    private struct Person {
        var dog = Dog()
        mutating func walk() {
            dog.run()
            dog.age = 1
        }
    }
}</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>队列实现</title>
    <url>/queue-implement/</url>
    <content><![CDATA[<p> <strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Algorithm</category>
      </categories>
  </entry>
  <entry>
    <title>栈实现</title>
    <url>/stack-implement/</url>
    <content><![CDATA[<p> <strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Algorithm</category>
      </categories>
  </entry>
  <entry>
    <title>自定义运算符</title>
    <url>/custom-operator/</url>
    <content><![CDATA[<p> <strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>线性表的顺序操作</title>
    <url>/sequential-operation-of-linear-tables/</url>
    <content><![CDATA[<pre><code>#include &lt;stdio.h&gt;

#define maxsize 10
#define failure -1
#define success 1
typedef int datatype;

typedef struct {
    datatype data[maxsize];
    int length;
} Seqlist;

typedef Seqlist* List;

///求表长度 o(1)
int length(Seqlist L) {
    return L.length;
}

/// 取表元 O(n)
datatype get(List L, int index) {
    if (index &lt; 1 || index &gt; L-&gt;length ) {
        return failure;
    }
    return L-&gt;data[index - 1];
}

/// 定位 O(n)
int locate(List L, datatype x) {
// for (int i = 0; i &lt; L-&gt;length - 1; i++) {
// if (x == L-&gt;data[i]) {
// return i + 1;
// }
// }
// return failure;
    int i = 0;
    while (i &lt; L-&gt;length &amp;&amp; L-&gt;data[i] != x) {
        i++;
    }
    if (i &lt; L-&gt;length) {
        return i + 1;
    } else {
        return failure;
    }
}

/// 删除 O(n)
int delete(List L, int index) {
    if (index &lt; 1 || index &gt; L-&gt;length) {
        return failure;
    }
    for (int j = index; j &lt; L-&gt;length; j++) {
        L-&gt;data[j - 1] = L-&gt;data[j];
    }
    return success;
}

/// 插入 O(n)
int insert(List L, datatype x, int index) {

    if (L-&gt;length == maxsize) {
        return failure; //表满
    }
    if (index &lt; 1 || index &gt; L-&gt;length + 1) {
        return failure; //位置错
    }

    for (int j = L-&gt;length; j &gt;= index; j--) {
        L-&gt;data[j] = L-&gt;data[j - 1];
    }
    L-&gt;data[index - 1] = x;
    L-&gt;length++;
    return success;
}



int main(int argc, const char * argv[]) {
    List L = (List)malloc(sizeof(Seqlist));
    L-&gt;length = 0;
    printf(&quot;%d\n&quot;, length(*L));
    int result = insert(L, 0, 1);
    printf(&quot;%d\n&quot;, result);
    printf(&quot;%d\n&quot;, length(*L));

    printf(&quot;取表元 %d\n&quot;, get(L, 0));
    return 0;
}</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Algorithm</category>
      </categories>
  </entry>
  <entry>
    <title>subscript_keyPath,propertyWrapper</title>
    <url>/subscript_keypath-propertywrapper/</url>
    <content><![CDATA[<pre><code>import Foundation

//dynamicMemberLookup_keyPath
struct Address {
    let street: String
    let zipCode: String
    let city: String
}

@dynamicMemberLookup
struct Person {
    let firstName: String
    let lastName: String
    private let address: Address

    init(firstName: String, lastName: String, address: Address) {
        self.firstName = firstName
        self.lastName = lastName
        self.address = address
    }

    subscript&lt;T&gt;(dynamicMember keyPath: KeyPath&lt;Address, T&gt;) -&gt; T {
        self.address[keyPath: keyPath]
    }

}

let address = Address(street: &quot;青岛街&quot;, zipCode: &quot;266700&quot;, city: &quot;北京市&quot;)
let person = Person(firstName: &quot;五&quot;, lastName: &quot;王&quot;, address: address)
print(person.firstName)

//property_wrappers
//https://www.avanderlee.com/swift/property-wrappers/
extension UserDefaults {

    public enum Keys {
        static let hasSeenAppIntroduction = &quot;has_seen_app_introduction&quot;
    }

    var hasSeenAppIntroduction: Bool {
        set {
            set(newValue, forKey: Keys.hasSeenAppIntroduction)
        }
        get {
            bool(forKey: Keys.hasSeenAppIntroduction)
        }
    }
}

UserDefaults.standard.hasSeenAppIntroduction = true
print(UserDefaults.standard.hasSeenAppIntroduction)

@propertyWrapper
struct UserDefault&lt;T&gt; {
    let key: String
    let defaultValue: T

    init(_ key: String, defaultValue: T) {
        self.key = key
        self.defaultValue = defaultValue
    }

    var value: T {
        get {
            UserDefaults.standard.value(forKey: key) as? T ?? defaultValue
        }
        set {
            UserDefaults.standard.set(newValue, forKey: key)
        }
    }
}

struct UserDefaultsConfig {
    @UserDefault(&quot;has_seen_app_introduction&quot;, defaultValue: false)
    static var hasSeenAppIntroduction: Bool
}

print(UserDefaultsConfig.hasSeenAppIntroduction)</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>求最大子列和</title>
    <url>/finding-the-maximum-subcolumn-sum/</url>
    <content><![CDATA[<pre><code>var nums = [1, -2, 2, -13, 6, -10, 3, 12]

/// O(n^3)
func maxSubSequenceSum1() {
    var maxSum = 0
    for i in 0..&lt;nums.count {
        for j in i..&lt;nums.count {
            var thisSum = 0
            for k in i...j {
                thisSum += nums[k]
            }
            if thisSum &gt; maxSum {
                maxSum = thisSum
            }
        }
    }
    print(maxSum)
}

/// O(n^2)
func maxSubSequenceSum2() {
    var maxSum = 0
    for i in 0..&lt;nums.count {
        var thisSum = 0
        for j in i..&lt;nums.count {
            thisSum += nums[j]
            if thisSum &gt; maxSum {
                maxSum = thisSum
            }
        }
    }
    print(maxSum)
}

/// O(n)
func maxSubSequenceSum3() {
    var maxSum = 0, thisSum = 0
    for i in 0..&lt;nums.count {
        thisSum += nums[i]
        if thisSum &gt; 0 {
            maxSum = thisSum
        } else { //如果thisSum小于0,则不可能使后面的部分和增大,抛弃.
            thisSum = 0
        }
    }
    print(maxSum)
}

maxSubSequenceSum1()
maxSubSequenceSum2()
maxSubSequenceSum3()</code></pre><p>算法很重要呐 😄😄</p>
<p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Algorithm</category>
      </categories>
  </entry>
  <entry>
    <title>打破for循环嵌套</title>
    <url>/how-to-break-out-of-multiple-loop-levels-using-labeled-statements/</url>
    <content><![CDATA[<pre><code>exitLoop: for i in 0...100 {
    print(&quot;i=\(i)&quot;)
    if i == 50 {
// break
    } else {
        for j in 0...100 {
            print(&quot;j=\(j)&quot;)
            if j == 50 {
                break exitLoop
            }
        }
    }
}</code></pre><p>参考: <a href="https://www.hackingwithswift.com/example-code/language/how-to-break-out-of-multiple-loop-levels-using-labeled-statements" target="_blank" rel="noopener">https://www.hackingwithswift.com/example-code/language/how-to-break-out-of-multiple-loop-levels-using-labeled-statements</a></p>
<p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>SourceTree不能使用账号密码提交代码</title>
    <url>/sourcetree-could-not-commit-code-by-username/</url>
    <content><![CDATA[<p>总感觉用账号密码提交代码是反人类的🙂</p>
<p>解决方法:</p>
<blockquote>
<p>SourceTree -&gt; 偏好设置-&gt; Git -&gt; 使用系统安装的Git</p>
</blockquote>
<p>好长时间不写博客了,能水一篇是一篇.</p>
<p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Git</category>
      </categories>
  </entry>
  <entry>
    <title>2018年总结</title>
    <url>/summary-of-2018/</url>
    <content><![CDATA[<h1 id="穷折腾"><a href="#穷折腾" class="headerlink" title="穷折腾"></a>穷折腾</h1><h1 id="🙂"><a href="#🙂" class="headerlink" title="🙂"></a>🙂</h1><!--kg-card-end: html-->]]></content>
      <categories>
        <category>Me</category>
      </categories>
  </entry>
  <entry>
    <title>位运算</title>
    <url>/bit-operation/</url>
    <content><![CDATA[<p>位运算了解一下,哈哈哈哈哈哈…</p>
<p>Person.swift</p>
<pre><code>import Foundation

extension Bool {
    init(_ integer: Int){
        self.init(integer != 0)
    }
}

struct Person {

    let TallMask = (0b00000001 &lt;&lt; 0b00000000)
    let RichMask = (0b00000001 &lt;&lt; 0b00000001)
    let HandsomeMask = (0b00000001 &lt;&lt; 0b00000010)

    var _tallRichHandsome = 0b00000000

    mutating func setTall(_ tall: Bool) {
        if tall {
            _tallRichHandsome = (_tallRichHandsome | TallMask)
        } else {
            _tallRichHandsome = (_tallRichHandsome &amp; ~TallMask)
        }
    }

    func isTall() -&gt; Bool {
        return Bool(_tallRichHandsome &amp; TallMask)
    }

    mutating func setRich(_ rich: Bool) {
        if rich {
            _tallRichHandsome = (_tallRichHandsome | RichMask)
        } else {
            _tallRichHandsome = (_tallRichHandsome &amp; ~RichMask)
        }
    }

    func isRich() -&gt; Bool {
        return Bool(_tallRichHandsome &amp; RichMask)
    }

    mutating func setHandsome(_ handsome: Bool) {
        if handsome {
            _tallRichHandsome = (_tallRichHandsome | HandsomeMask)
        } else {
            _tallRichHandsome = (_tallRichHandsome &amp; ~HandsomeMask)
        }
    }

    func isHandsome() -&gt; Bool {
        return Bool(_tallRichHandsome &amp; HandsomeMask)
    }
}</code></pre><p>main.swift</p>
<pre><code>import Foundation


var person = Person()

print(person.isTall())
print(person.isRich())
print(person.isHandsome())
print(&quot;================&quot;)
print(person._tallRichHandsome)
print(&quot;===================&quot;)
person.setTall(true)
person.setRich(true)
person.setHandsome(true)
print(person.isTall())
print(person.isRich())
print(person.isHandsome())

print(&quot;===================&quot;)
//print(person.TallMask)
//print(person.RichMask)
//print(person.HandsomeMask)
person.setTall(false)
print(person.isTall())
print(person.isRich())
print(person.isHandsome())

print(&quot;==================&quot;)
//print(0b00000000)
//print(0b00000001)
//print(0b00000010)

print(&quot;==================&quot;)

print(person._tallRichHandsome)</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>OC对象的分类</title>
    <url>/oc-object-classify/</url>
    <content><![CDATA[<pre><code>//实例对象(instance对象)
    //isa指针
    //变量
//类对象(Class对象)
    //每个类有且只有一个类对象
    //class对象在内存中存储的主要信息有:
    //isa指针
    //superclass指针
    //类属性信息(@property), 类的对象信息(instance method)
    //类的协议信息(protocol),成员变量信息(ivar)
//元类对象(meta class)
    //每个类只有一个元类对象
    //元类对象跟类对象内存结构是一样的
    //包括:
    //isa指针
    //superclass指针
    //类的类方法信息 (class method,+号开头)

#import &lt;Foundation/Foundation.h&gt;
#import &lt;objc/runtime.h&gt;

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        //实例对象(instance对象)
        NSObject *obj1 = [[NSObject alloc] init];
        NSObject *obj2 = [[NSObject alloc] init];

        //类对象(Class对象)
        Class objClass1 = [obj1 class]; //类对象
        Class objClass2 = [obj2 class];
        Class objClass3 = object_getClass(obj2);
        Class objClass4 = object_getClass(obj1);
        Class objClass5 = [NSObject class];
        NSLog(@&quot;%p&quot;, objClass1);
        NSLog(@&quot;%p&quot;, objClass2);
        NSLog(@&quot;%p&quot;, objClass3);
        NSLog(@&quot;%p&quot;, objClass4);
        NSLog(@&quot;%p&quot;, objClass5);

        //元类对象(meta class对象)
        Class metaClass = object_getClass([NSObject class]);
    }
    return 0;
}</code></pre><p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>Protocols</title>
    <url>/protocols/</url>
    <content><![CDATA[<p>A protocol defines a blueprint of methods, properties, and other requirements that suit a particular task or piece of functionality. The protocol can then be adopted by a class, structure, or enumeration to provide an actual implementation of those requirements. Any type that satisfies the requirements of a protocol is said to conform to that protocol.</p>
<pre><code>import Foundation

//协议语法
protocol SomeProtocol {

}

struct SomeStructure: SomeProtocol {}
class SomeClass: SomeProtocol {}

//属性要求
//如果属性标注了(set get),则不能通过常量存储属性和只读计算属性来实现
//如果属性只设置了(get),那么任何类型都可以满足,包括变量存储属性

protocol SomeProtocol1 {
    var mustBeSettable: Int { get set }
    var doesNotNeedToBeSettable: Int { get }
}

//协议中用static修饰时,实现中用static或者class实现都行
protocol AnotherProtocol {
    static var someTypeProperty: Int { get set }
}

protocol FullyNamed {
    var fullName: String { get }
}

struct Person: FullyNamed {
    var fullName: String
}
//可set 可 get
let john = Person(fullName: &quot;Tom&quot;)

class Starship: FullyNamed {
    var prefix: String?
    var name: String

    init(name: String, prefix: String? = nil) {
        self.name = name
        self.prefix = prefix
    }

    var fullName: String {
        return (prefix != nil ? prefix!+&quot; &quot; : &quot;&quot;) + name
    }
}

var ncc1701 = Starship(name: &quot;Enterprise&quot;, prefix: &quot;USS&quot;)

//方法要求

//不能在协议方法中指定默认值

protocol SomeProtocol2 {
    static func someTypeMethod()
}

protocol RandomNumberGenerator {
    func random() -&gt; Double
}

//线性同余生成器的伪随机数生成器算法,好高大上有木有...
class LinearCongruentialGenerator: RandomNumberGenerator {
    var lastRandom = 42.0
    let m = 139968.0
    let a = 3877.0
    let c = 29573.0
    func random() -&gt; Double {
        lastRandom = ((lastRandom * a + c).truncatingRemainder(dividingBy: m))
        return lastRandom / m
    }
}

let generator = LinearCongruentialGenerator()
print(generator.random())
print(generator.random())

//变异方法要求 mutating method requirements
//如果希望实现协议的任何类型(类,结构体,枚举)要修改实例或者实例中的任何属性
//得在func前加mutating关键字
//类实现时,无需加mutating,结构体,枚举需要加
protocol Toggleable {
    mutating func toggle()
}

enum OnOffSwitch: Toggleable {
    case off, on
    mutating func toggle() {
        switch self {
        case .on:
            self = .off
        case .off:
            self = .on
        }
    }
}

var lightSwitch = OnOffSwitch.off
print(lightSwitch)
lightSwitch.toggle()
print(lightSwitch)

//初始化程序要求
protocol SomeProtocol3 {
    init(someParameter: Int)
}

//required 方便子类继承,从而遵守SomeProtocol3协议
//如果给类加上final,则required可以省略
final class SomeClass3: SomeProtocol3 {
    required init(someParameter: Int) {
        //在这进行初始化实现
    }
}

//如果子类重写父类中init方法,并且这个init也是协议中的实现,则需要用
//`required`和`override`修饰
protocol SomeProtocol4 {
    init()
}

class SomeSuperClass {
    init() {

    }
}

class SomeSubClass: SomeSuperClass, SomeProtocol4 {
    required override init() {
        //good job
    }
}

//协议还可以定义可失败构造器

//协议作为类型
//协议本身不实现任何功能,但是,创建的任何协议都会变成代码中成熟的类型.
//可以用协议的地方:
//1. 在函数,方法或初始化方法中作为参数或返回值
//2. 作为常量,变量,或者属性的类型
//3. 作为数组,字典或其他容器类型的元素类型

class Dice {
    let sides: Int
    let generator: RandomNumberGenerator
    init(sides: Int, generator: RandomNumberGenerator) {
        self.sides = sides
        self.generator = generator
    }
    func roll() -&gt; Int {
        return Int(generator.random() * Double(sides)) + 1
    }
}
var d6 = Dice(sides: 6, generator: LinearCongruentialGenerator())
for _ in 1...5 {
    print(&quot;Random dice roll is \(d6.roll())&quot;)
}

//委托
//响应特定操作或者从外部检索数据
protocol DiceGame {
    var dice: Dice { get }
    func play()
}

protocol DiceGameDelegate: AnyObject {
    func gameDidStart(_ game: DiceGame)
    func game(_ game: DiceGame, didStartNewTurnWithDiceRoll diceRoll: Int)
    func gameDidEnd(_ game: DiceGame)
}

class SnakesAndLadders: DiceGame {
    let finalSquare = 25
    let dice = Dice(sides: 6, generator: LinearCongruentialGenerator())
    var square = 0
    var board: [Int]

    init() {
        board = Array(repeating: 0, count: finalSquare + 1)
        board[03] = +08; board[06] = +11; board[09] = +09; board[10] = +02
        board[14] = -10; board[19] = -11; board[22] = -02; board[24] = -08
    }

    weak var delegate: DiceGameDelegate?
    func play() {
        square = 0
        delegate?.gameDidStart(self)
        gameLoop: while square != finalSquare {
            let diceRoll = dice.roll()
            delegate?.game(self, didStartNewTurnWithDiceRoll: diceRoll)
            switch square + diceRoll {
            case finalSquare:
                break gameLoop
            case let newSquare where newSquare &gt; finalSquare:
                continue gameLoop
            default:
                square += diceRoll
                square += board[square]
            }
        }
        delegate?.gameDidEnd(self)
    }
}

class DiceGameTracker: DiceGameDelegate {
    var numberOfTurns = 0
    func gameDidStart(_ game: DiceGame) {
        numberOfTurns = 0
        if game is SnakesAndLadders {
            print(&quot;Started a new game of Snakes and Ladders&quot;)
        }
        print(&quot;The game is using a \(game.dice.sides)-sided dice&quot;)
    }
    func game(_ game: DiceGame, didStartNewTurnWithDiceRoll diceRoll: Int) {
        numberOfTurns += 1
        print(&quot;Rolled a \(diceRoll)&quot;)
    }
    func gameDidEnd(_ game: DiceGame) {
        print(&quot;The game lasted for \(numberOfTurns) turns&quot;)
    }
}

let tracker = DiceGameTracker()
let game = SnakesAndLadders()
game.delegate = tracker
game.play()

//通过扩展遵守某个协议
protocol TextRepresentable {
    var textualDescription: String { get }
}

extension Dice: TextRepresentable {
    var textualDescription: String {
        return &quot;A \(sides)-sided dice&quot;
    }
}

let d12 = Dice(sides: 12, generator: LinearCongruentialGenerator())
print(d12.textualDescription)
// Prints &quot;A 12-sided dice&quot;

extension SnakesAndLadders: TextRepresentable {
    var textualDescription: String {
        return &quot;A game of Snakes and Ladders with \(finalSquare) squares&quot;
    }
}
print(game.textualDescription)

//有条件的遵守协议
extension Array: TextRepresentable where Element: TextRepresentable {
    var textualDescription: String {
        let itemsAsText = self.map { $0.textualDescription }
        return &quot;[&quot; + itemsAsText.joined(separator: &quot;, &quot;) + &quot;]&quot;
    }
}
let myDice = [d6, d12]
print(myDice.textualDescription)

//通过协议适应某种类型
//如果某个类型已经符合协议的所有要求，但尚未声明它采用该协议，则可以使其采用带有空扩展的协议
struct Hamster {
    var name: String
    var textualDescription: String {
        return &quot;A hamster named \(name)&quot;
    }
}
extension Hamster: TextRepresentable {}
let simonTheHamster = Hamster(name: &quot;Simon&quot;)
let somethingTextRepresentable: TextRepresentable = simonTheHamster
print(somethingTextRepresentable.textualDescription)
// Prints &quot;A hamster named Simon&quot;

//协议类型的集合
let things: [TextRepresentable] = [game, d12, simonTheHamster]
for thing in things {
    print(thing.textualDescription)
}

//协议继承</code></pre><p>还是有点烧脑….</p>
<p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>Generics</title>
    <url>/generics/</url>
    <content><![CDATA[<!--kg-card-begin: markdown-->

<p>通用代码使您能够根据您定义的要求编写可以使用任何类型的灵活，可重用的函数和类型。您可以编写避免重复的代码，并以清晰，抽象的方式表达其意图。</p>
<p>泛型是Swift最强大的功能之一，Swift标准库的大部分内容都是使用通用代码构建的。</p>
<pre><code>import Foundation

//泛型函数
func swapTwoValues&lt;T&gt;(_ a: inout T, _ b: inout T) {
    let tmp = a
    a = b
    b = tmp
}

var a = 1, b = 2
print(&quot;\(a)====\(b)&quot;)
swapTwoValues(&amp;a, &amp;b)
print(&quot;\(a)====\(b)&quot;)

//泛型类型(泛型类,泛型结构体,泛型枚举),听起来挺高大上,其实就是给自定义类加个泛型
struct Stack&lt;Element&gt; {
    var items: [Element] = []
    mutating func push(_ item: Element) {
        items.append(item)
    }

    mutating func pop() -&gt; Element {
        return items.removeLast()
    }
}
//扩展泛型类型
extension Stack {
    var topItem: Element? {
        return items.isEmpty ? nil : items[items.count - 1]
    }
}

var strings = Stack&lt;String&gt;()
strings.push(&quot;hello&quot;)
print(strings.topItem)
print(strings.pop())

//泛型约束(不限于泛型类型,除了泛型类型就是TM的泛型函数)
//泛型约束不能省略,如果省略value == v就不能运行了,没法玩了.
//泛型约束必须是特定类继承，或符合特定协议或协议组合
//这里Equable不能被替换为String,因为String是结构体,不能被继承.Int, Bool, Double, anything else...
//返回值不能用泛型,🙂because the type to use for T is inferred from the types of values passed to the function.
// (因为类型都是从传递给函数的值的类型推断出来的),除非再传一个参数,类似:
// func findIndex1&lt;T: Equatable, S: SignedInteger&gt;(of value: T,in array: [T], _ type: S) -&gt; S?
// 告诉一下Swift,接下来会发生什么,不然Swift心里会发慌...
func findIndex1&lt;T: Equatable&gt;(of value: T,in array: [T]) -&gt; Int? {
    for (i, v) in array.enumerated() {
        if value == v {
            return i
        }
    }
    return nil
}

let arr = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]
let index = findIndex1(of: &quot;a&quot;, in: arr)
print(index)


//关联类型
//协议中的泛型,实现具体类型的时候,由自己指定泛型类型为某种具体类型.
protocol Container {
    associatedtype Item
    mutating func append(_ item: Item)
    var count: Int { get }
    subscript(i: Int) -&gt; Item { get }
}

//这里typealias item不能等于协议,例如typealias Item = Equatable
//这样Swift就不知道`EquableStack`应该怎么分配内存了有木有...,谁TM知道`EquableStack`实现了几个协议
//脚踏了几只船?
//typealias Item = Int删掉也可以,可以通过append,推断出Item类型
struct IntStack: Container {

    mutating func push(_ item: Item) {
        items.append(item)
    }

    mutating func pop() -&gt; Item {
        return items.removeLast()
    }

    typealias Item = Int
    var items: [Item] = []
    mutating func append(_ item: Item) {
        items.append(item)
    }
    var count: Int {
        return items.count
    }

    subscript(i: Int) -&gt; Item {
        return items[i]
    }
}

//上面的Stack可以写作下面方式
//因为通过append可以知道Element为Item的具体类型,所以typealias可以省略
//又因为Stack1是泛型类型,Element创建实例对象时具体指出,所以,一下代码完全正确.
//可以写typealias Item = Element, 然后Element跟Item可以互相交叉替换🙂
struct Stack1&lt;Element&gt;: Container {
    var items = [Element]()
    mutating func push(_ item: Element) {
        items.append(item)
    }

    mutating func pop() -&gt; Element {
        return items.removeLast()
    }
    //conformance to the Container
    mutating func append(_ item: Element) {
        push(item)
    }
    var count: Int {
        return items.count
    }
    subscript(i: Int) -&gt; Element {
        return items[i]
    }
}

var strings1 = Stack1&lt;String&gt;()
strings.push(&quot;hello&quot;)
print(strings.topItem)
print(strings.pop())

//扩展现有类型以指定关联类型
//array 中有append用来推断具体类型,并且有count,有下标
//所以以后完全可以使用Array作为Container
//但是typealias Container = Array也是不错的
extension Array: Container {}

//将约束添加到关联类型
//如果这样定义,得像下面这样搞
//struct Stack1&lt;Element: Equatable&gt;: Container
protocol Container1 {
    associatedtype Item: Equatable
    mutating func append(_ item: Item)
    var count: Int { get }
    subscript(i: Int) -&gt; Item { get }
}

//在关联类型的约束中使用协议
//这个JB关系有点乱,有木有...
//儿子有一个家,爹有一个家,儿子从爹那继承过来的家跟自己成立的家必须是一个家,不能搞分家...
//大概就是这样了....
protocol SuffixableContainer: Container {
    associatedtype Suffix: SuffixableContainer where Suffix.Item == Item
    func suffix(_ size: Int) -&gt; Suffix
}

extension Stack1: SuffixableContainer {
    func suffix(_ size: Int) -&gt; Stack1 {
        var result = Stack1()
        //max是用来防止程序崩溃的,🙂
        for index in max((count-size), 0)..&lt;count {
            result.append(self[index])
        }
        return result
    }
    // Inferred that Suffix is Stack.
}

var stackOfInts = Stack1&lt;Int&gt;()
stackOfInts.append(10)
stackOfInts.append(20)
stackOfInts.append(30)
let suffix = stackOfInts.suffix(3)

//Generic Where Clauses(通用条款)
//泛型条件约束吧... where

func allItemsMatch&lt;C1: Container, C2: Container&gt;(_ someContainer: C1, _ anotherContainer: C2) -&gt; Bool where C1.Item == C2.Item, C1.Item: Equatable {
    // Check that both containers contain the same number of items.
    if someContainer.count != anotherContainer.count {
        return false
    }
    // Check each pair of items to see if they&apos;re equivalent.
    for i in 0..&lt;someContainer.count {
        if someContainer[i] != anotherContainer[i] {
            return false
        }
    }
    // All items match, so return true.
    return true
}

var stackOfStrings = Stack1&lt;String&gt;()
stackOfStrings.push(&quot;uno&quot;)
stackOfStrings.push(&quot;dos&quot;)
stackOfStrings.push(&quot;tres&quot;)

var arrayOfStrings = [&quot;uno&quot;, &quot;dos&quot;, &quot;tres&quot;]

if allItemsMatch(stackOfStrings, arrayOfStrings) {
    print(&quot;All items match.&quot;)
} else {
    print(&quot;Not all items match.&quot;)
}

extension Stack1 where Element: Equatable {
    func isTop(_ item: Element) -&gt; Bool {
        guard let last = items.last else {
            return false
        }
        return item == last
    }
}
//如果将没有遵守Equatable用于该方法,会报错
if stackOfStrings.isTop(&quot;tres&quot;) {
    print(&quot;Top element is tres.&quot;)
} else {
    print(&quot;Top element is something else.&quot;)
}

//上面where扩展类型,下面where扩展协议,这TM就比较6了...
extension Container where Item: Equatable {
    func startsWith(_ item: Item) -&gt; Bool {
        return count &gt;= 1 &amp;&amp; self[0] == item
    }
}
if [9, 9, 9].startsWith(42) {
    print(&quot;Starts with 42.&quot;)
} else {
    print(&quot;Starts with something else.&quot;)
}

//Item是特定类型的where子句
extension Container where Item == Double {
    func average() -&gt; Double {
        var sum = 0.0
        for index in 0..&lt;count {
            sum += self[index]
        }
        return sum / Double(count)
    }
}
print([1260.0, 1200.0, 98.6, 37.0].average())


//关联类型和泛型子句
protocol Container2 {
    associatedtype Item
    mutating func append(_ item: Item)
    var count: Int { get }
    subscript(i: Int) -&gt; Item { get }

    associatedtype Iterator: IteratorProtocol where Iterator.Element == Item

    func makeIterator() -&gt; Iterator
}

protocol ComparableContainer: Container2 where Item: Comparable {}

//泛型下标
extension Container2 {
    subscript&lt;Indices: Sequence&gt;(indices: Indices) -&gt; [Item]
        where Indices.Iterator.Element == Int {
            var result = [Item]()
            for index in indices {
                result.append(self[index])
            }
            return result
    }
}</code></pre><p>真是烧脑的玩意……</p>
<p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->

]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>LLVM</title>
    <url>/llvm/</url>
    <content><![CDATA[<h3 id="LLVM"><a href="#LLVM" class="headerlink" title="LLVM:"></a>LLVM:</h3><p>模块化,可重用的编译器以及工具链技术集合.</p>
<p>创始人: Chris Lattner</p>
<p>LLVM不是Low Level Virtual Machine(低级虚拟机)的缩写,LLVM就是他的项目全名.</p>
<h3 id="传统编译器"><a href="#传统编译器" class="headerlink" title="传统编译器:"></a>传统编译器:</h3><p>GCC<br>Clang</p>
<h4 id="传统编译器架构"><a href="#传统编译器架构" class="headerlink" title="传统编译器架构:"></a>传统编译器架构:</h4><p><img alt="ping-mu-kuai-zhao-2018-10-26-xia-wu-9-53-38" data-src="https://pic.jingxuetao.com/201810/ping-mu-kuai-zhao-2018-10-26-xia-wu-9-53-38.png"></p>
<ul>
<li>Frontend: 前端</li>
</ul>
<blockquote>
<p>词法分析,语法分析,语义分析,生成中间代码</p>
</blockquote>
<ul>
<li>Opotimizer: 优化器</li>
</ul>
<blockquote>
<p>中间代码优化</p>
</blockquote>
<ul>
<li>Backend: 后端</li>
</ul>
<blockquote>
<p>生成机器码</p>
</blockquote>
<h3 id="LLVM架构"><a href="#LLVM架构" class="headerlink" title="LLVM架构"></a>LLVM架构</h3><p><img alt="ping-mu-kuai-zhao-2018-10-26-xia-wu-9-58-59" data-src="https://pic.jingxuetao.com/201810/ping-mu-kuai-zhao-2018-10-26-xia-wu-9-58-59.png"></p>
<ul>
<li>不同的前端后端使用统一的中间代码 LLVM Intermediate Representation(LLVM IR).</li>
<li>如果需要支持一种新的编程语言,只需要实现一个新的前端.</li>
<li>如果需要支持一种新的硬件设备,只需要增加一个新的后端.</li>
<li>优化阶段是一个通用阶段,它针对的是统一的LLVM IR,无论是支持新的编程语言,还是支持新的硬件设备,都不需要对优化阶段做修改.</li>
<li>相比之下,GCC的前端和后端没分的泰开,前端后端耦合在一起.所以GCC为了来支持一门新的语言或者新的硬件设备,就变得很困难.</li>
<li>LLVM现在被用作为实现各种静态和运行时变易语言的通用基础结构.(GCC家族,Java,.net,Python等)</li>
</ul>
<h3 id="Clang"><a href="#Clang" class="headerlink" title="Clang"></a>Clang</h3><ul>
<li>LLVM一个子项目</li>
<li>基于LVVM架构的C/C++/Objective-C编译器前端</li>
</ul>
<p>优点:</p>
<ul>
<li>编译速度快,在某些平台上Clang的便以速度显著地快过GCC</li>
<li>占用内存小,Clang生成的AST所占用的内训师CGG的五分之一左右</li>
<li>模块化设计,基于库的模块化设计,易于IDE集成以及其他用途的重用</li>
<li>诊断信息可读性强: 在编译过程中,Clang创建并保留了大量详细的元数据(metadata),有利于调试和错误解读.</li>
<li>设计清晰简单,容易理解,易于扩展增强</li>
</ul>
<h2 id="Clang与LLVM"><a href="#Clang与LLVM" class="headerlink" title="Clang与LLVM"></a>Clang与LLVM</h2><p><img alt="ping-mu-kuai-zhao-2018-10-26-xia-wu-10-17-23" data-src="https://pic.jingxuetao.com/201810/ping-mu-kuai-zhao-2018-10-26-xia-wu-10-17-23.png"></p>
<ul>
<li>广义LLVM</li>
</ul>
<blockquote>
<p>整个LLVM架构</p>
</blockquote>
<ul>
<li>狭义LLVM</li>
</ul>
<blockquote>
<p>LLVM后端(代码优化,目标代码生成等)</p>
</blockquote>
<p><img alt="ping-mu-kuai-zhao-2018-10-26-xia-wu-10-22-37" data-src="https://pic.jingxuetao.com/201810/ping-mu-kuai-zhao-2018-10-26-xia-wu-10-22-37.png"></p>
<h2 id="OC源文件编译过程"><a href="#OC源文件编译过程" class="headerlink" title="OC源文件编译过程"></a>OC源文件编译过程</h2><h3 id="命令行查看编译过程"><a href="#命令行查看编译过程" class="headerlink" title="命令行查看编译过程"></a>命令行查看编译过程</h3><blockquote>
<p>clang -ccc-print-phases main.m</p>
</blockquote>
<pre><code>➜ TestSwift clang -ccc-print-phases main.swift
0: input, &quot;main.swift&quot;, object
1: linker, {0}, image
2: bind-arch, &quot;x86_64&quot;, {1}, image

➜ TestOC clang -ccc-print-phases main.m
0: input, &quot;main.m&quot;, objective-c
1: preprocessor, {0}, objective-c-cpp-output
2: compiler, {1}, ir
3: backend, {2}, assembler
4: assembler, {3}, object
5: linker, {4}, image
6: bind-arch, &quot;x86_64&quot;, {5}, image</code></pre><blockquote>
<p>Swift比OC少了4个编译阶段呐,有木有…</p>
</blockquote>
<h3 id="查看preprocessor-预处理-的结果"><a href="#查看preprocessor-预处理-的结果" class="headerlink" title="查看preprocessor(预处理)的结果"></a>查看preprocessor(预处理)的结果</h3><blockquote>
<p>clang -E main.m</p>
</blockquote>
<pre><code>//源文件
print(&quot;Hello World&quot;)
//预处理输出
➜ TestSwift clang -E main.swift
clang: warning: main.swift: &apos;linker&apos; input unused [-Wunused-command-line-argument]

//源文件
#define AGE 10

int main(int argc, const char * argv[]) {

    int a = 10;
    int b = 20;
    int c = a + b + AGE;

    return 0;
}
//预处理输出
➜ TestOC clang -E main.m
# 1 &quot;main.m&quot;
# 1 &quot;&lt;built-in&gt;&quot; 1
# 1 &quot;&lt;built-in&gt;&quot; 3
# 373 &quot;&lt;built-in&gt;&quot; 3
# 1 &quot;&lt;command line&gt;&quot; 1
# 1 &quot;&lt;built-in&gt;&quot; 2
# 1 &quot;main.m&quot; 2
# 11 &quot;main.m&quot;
int main(int argc, const char * argv[]) {

    int a = 10;
    int b = 20;
    int c = a + b + 10;

    return 0;
}</code></pre><h2 id="词法分析"><a href="#词法分析" class="headerlink" title="词法分析"></a>词法分析</h2><ul>
<li>词法分析,生成Token(类似英语中主语,谓语,宾语,宾补…)</li>
</ul>
<blockquote>
<p>clang -fmodules -E -Xclang -dump-tokens main.m</p>
</blockquote>
<pre><code>➜ TestSwift clang -fmodules -E -Xclang -dump-tokens main.swift
clang: warning: main.swift: &apos;linker&apos; input unused [-Wunused-command-line-argument]
clang: warning: argument unused during compilation: &apos;-fmodules&apos; [-Wunused-command-line-argument]
clang: warning: argument unused during compilation: &apos;-Xclang -dump-tokens&apos; [-Wunused-command-line-argument]

➜ TestOC clang -fmodules -E -Xclang -dump-tokens main.m
int &apos;int&apos; [StartOfLine]    Loc=&lt;main.m:11:1&gt;
identifier &apos;main&apos; [LeadingSpace]    Loc=&lt;main.m:11:5&gt;
l_paren &apos;(&apos; Loc=&lt;main.m:11:9&gt;
int &apos;int&apos; Loc=&lt;main.m:11:10&gt;
identifier &apos;argc&apos; [LeadingSpace]    Loc=&lt;main.m:11:14&gt;
comma &apos;,&apos; Loc=&lt;main.m:11:18&gt;
const &apos;const&apos; [LeadingSpace]    Loc=&lt;main.m:11:20&gt;
char &apos;char&apos; [LeadingSpace]    Loc=&lt;main.m:11:26&gt;
star &apos;*&apos; [LeadingSpace]    Loc=&lt;main.m:11:31&gt;
identifier &apos;argv&apos; [LeadingSpace]    Loc=&lt;main.m:11:33&gt;
l_square &apos;[&apos; Loc=&lt;main.m:11:37&gt;
r_square &apos;]&apos; Loc=&lt;main.m:11:38&gt;
r_paren &apos;)&apos; Loc=&lt;main.m:11:39&gt;
l_brace &apos;{&apos; [LeadingSpace]    Loc=&lt;main.m:11:41&gt;
int &apos;int&apos; [StartOfLine] [LeadingSpace]    Loc=&lt;main.m:13:5&gt;
identifier &apos;a&apos; [LeadingSpace]    Loc=&lt;main.m:13:9&gt;
equal &apos;=&apos; [LeadingSpace]    Loc=&lt;main.m:13:11&gt;
numeric_constant &apos;10&apos; [LeadingSpace]    Loc=&lt;main.m:13:13&gt;
semi &apos;;&apos; Loc=&lt;main.m:13:15&gt;
int &apos;int&apos; [StartOfLine] [LeadingSpace]    Loc=&lt;main.m:14:5&gt;
identifier &apos;b&apos; [LeadingSpace]    Loc=&lt;main.m:14:9&gt;
equal &apos;=&apos; [LeadingSpace]    Loc=&lt;main.m:14:11&gt;
numeric_constant &apos;20&apos; [LeadingSpace]    Loc=&lt;main.m:14:13&gt;
semi &apos;;&apos; Loc=&lt;main.m:14:15&gt;
int &apos;int&apos; [StartOfLine] [LeadingSpace]    Loc=&lt;main.m:15:5&gt;
identifier &apos;c&apos; [LeadingSpace]    Loc=&lt;main.m:15:9&gt;
equal &apos;=&apos; [LeadingSpace]    Loc=&lt;main.m:15:11&gt;
identifier &apos;a&apos; [LeadingSpace]    Loc=&lt;main.m:15:13&gt;
plus &apos;+&apos; [LeadingSpace]    Loc=&lt;main.m:15:15&gt;
identifier &apos;b&apos; [LeadingSpace]    Loc=&lt;main.m:15:17&gt;
plus &apos;+&apos; [LeadingSpace]    Loc=&lt;main.m:15:19&gt;
numeric_constant &apos;10&apos; [LeadingSpace]    Loc=&lt;main.m:15:21 &lt;Spelling=main.m:9:13&gt;&gt;
semi &apos;;&apos; Loc=&lt;main.m:15:24&gt;
return &apos;return&apos; [StartOfLine] [LeadingSpace]    Loc=&lt;main.m:17:5&gt;
numeric_constant &apos;0&apos; [LeadingSpace]    Loc=&lt;main.m:17:12&gt;
semi &apos;;&apos; Loc=&lt;main.m:17:13&gt;
r_brace &apos;}&apos; [StartOfLine]    Loc=&lt;main.m:18:1&gt;
eof &apos;&apos; Loc=&lt;main.m:18:2&gt;</code></pre><h2 id="语法分析"><a href="#语法分析" class="headerlink" title="语法分析"></a>语法分析</h2><ul>
<li>语法分析,生成语法树(AST, Abstract Syntax Tree)</li>
</ul>
<blockquote>
<p>clang -fmodules -fsyntax-only -Xclang -ast-dump main.m</p>
</blockquote>
<pre><code>➜ Test clang -fmodules -fsyntax-only -Xclang -ast-dump main.swift
clang: warning: main.swift: &apos;linker&apos; input unused [-Wunused-command-line-argument]
clang: warning: argument unused during compilation: &apos;-fmodules&apos; [-Wunused-command-line-argument]
clang: warning: argument unused during compilation: &apos;-Xclang -ast-dump&apos; [-Wunused-command-line-argument]

➜ TestOC clang -fmodules -fsyntax-only -Xclang -ast-dump main.m
TranslationUnitDecl 0x7ff3730298e8 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt;
|-TypedefDecl 0x7ff373029e60 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit __int128_t &apos;__ int128&apos;
| `-BuiltinType 0x7ff373029b80 &apos;__int128&apos;
|-TypedefDecl 0x7ff373029ed0 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit __uint128_t &apos;unsigned__ int128&apos;
| `-BuiltinType 0x7ff373029ba0 &apos;unsigned __int128&apos;
|-TypedefDecl 0x7ff373029f70 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit SEL &apos;SEL *&apos;
| `-PointerType 0x7ff373029f30 &apos;SEL *&apos;
| `-BuiltinType 0x7ff373029dc0 &apos;SEL&apos;
|-TypedefDecl 0x7ff37302a058 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit id &apos;id&apos;
| `-ObjCObjectPointerType 0x7ff37302a000 &apos;id&apos;
| `-ObjCObjectType 0x7ff373029fd0 &apos;id&apos;
|-TypedefDecl 0x7ff37302a138 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit Class &apos;Class&apos;
| `-ObjCObjectPointerType 0x7ff37302a0e0 &apos;Class&apos;
| `-ObjCObjectType 0x7ff37302a0b0 &apos;Class&apos;
|-ObjCInterfaceDecl 0x7ff37302a190 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit Protocol
|-TypedefDecl 0x7ff37302a4f8 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit __NSConstantString &apos;struct__ NSConstantString_tag&apos;
| `-RecordType 0x7ff37302a300 &apos;struct __NSConstantString_tag&apos;
| `-Record 0x7ff37302a260 &apos;__NSConstantString_tag&apos;
|-TypedefDecl 0x7ff37302a590 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit __builtin_ms_va_list &apos;char *&apos;
| `-PointerType 0x7ff37302a550 &apos;char *&apos;
| `-BuiltinType 0x7ff373029980 &apos;char&apos;
|-TypedefDecl 0x7ff373062488 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit __builtin_va_list &apos;struct__ va_list_tag [1]&apos;
| `-ConstantArrayType 0x7ff373062430 &apos;struct __va_list_tag [1]&apos; 1
| `-RecordType 0x7ff3730622a0 &apos;struct __va_list_tag&apos;
| `-Record 0x7ff373062200 &apos;__va_list_tag&apos;
`-FunctionDecl 0x7ff373062758 &lt;main.m:11:1, line:18:1&gt; line:11:5 main &apos;int (int, const char **)&apos;
  |-ParmVarDecl 0x7ff3730624f8 &lt;col:10, col:14&gt; col:14 argc &apos;int&apos;
  |-ParmVarDecl 0x7ff373062610 &lt;col:20, col:38&gt; col:33 argv &apos;const char **&apos;:&apos;const char**&apos;
  `-CompoundStmt 0x7ff373062bd8 &lt;col:41, line:18:1&gt;
    |-DeclStmt 0x7ff373062928 &lt;line:13:5, col:15&gt;
    | `-VarDecl 0x7ff3730628a8 &lt;col:5, col:13&gt; col:9 used a &apos;int&apos; cinit
    | `-IntegerLiteral 0x7ff373062908 &lt;col:13&gt; &apos;int&apos; 10
    |-DeclStmt 0x7ff3730629d8 &lt;line:14:5, col:15&gt;
    | `-VarDecl 0x7ff373062958 &lt;col:5, col:13&gt; col:9 used b &apos;int&apos; cinit
    | `-IntegerLiteral 0x7ff3730629b8 &lt;col:13&gt; &apos;int&apos; 20
    |-DeclStmt 0x7ff373062b88 &lt;line:15:5, col:24&gt;
    | `-VarDecl 0x7ff373062a08 &lt;col:5, line:9:13&gt; line:15:9 c &apos;int&apos; cinit
    | `-BinaryOperator 0x7ff373062b60 &lt;col:13, line:9:13&gt; &apos;int&apos; &apos;+&apos;
    | |-BinaryOperator 0x7ff373062b18 &lt;line:15:13, col:17&gt; &apos;int&apos; &apos;+&apos;
    | | |-ImplicitCastExpr 0x7ff373062ae8 &lt;col:13&gt; &apos;int&apos; &lt;LValueToRValue&gt;
    | | | `-DeclRefExpr 0x7ff373062a68 &lt;col:13&gt; &apos;int&apos; lvalue Var 0x7ff3730628a8 &apos;a&apos; &apos;int&apos;
    | | `-ImplicitCastExpr 0x7ff373062b00 &lt;col:17&gt; &apos;int&apos; &lt;LValueToRValue&gt;
    | | `-DeclRefExpr 0x7ff373062aa8 &lt;col:17&gt; &apos;int&apos; lvalue Var 0x7ff373062958 &apos;b&apos; &apos;int&apos;
    | `-IntegerLiteral 0x7ff373062b40 &lt;line:9:13&gt; &apos;int&apos; 10
    `-ReturnStmt 0x7ff373062bc0 &lt;line:17:5, col:12&gt;
      `-IntegerLiteral 0x7ff373062ba0 &lt;col:12&gt; &apos;int&apos; 0</code></pre><h2 id="LLVM-IR"><a href="#LLVM-IR" class="headerlink" title="LLVM IR"></a>LLVM IR</h2><p>LLVM IR有三种表示形式(本质等价,好比水的气态,液态,固态)</p>
<p>1.text: 便于阅读的文本格式,类似于汇编语言,扩展名<code>.ll</code></p>
<pre><code>&gt; clang -S -emit-llvm main.m

; ModuleID = &apos;main.m&apos;
source_filename = &quot;main.m&quot;
target datalayout = &quot;e-m:o-i64:64-f80:128-n8:16:32:64-S128&quot;
target triple = &quot;x86_64-apple-macosx10.14.0&quot;

; Function Attrs: noinline nounwind optnone ssp uwtable
define i32 @main(i32, i8**) #0 {
  %3 = alloca i32, align 4
  %4 = alloca i32, align 4
  %5 = alloca i8**, align 8
  %6 = alloca i32, align 4
  %7 = alloca i32, align 4
  %8 = alloca i32, align 4
  store i32 0, i32* %3, align 4
  store i32 %0, i32* %4, align 4
  store i8 **%1, i8*** %5, align 8
  store i32 10, i32* %6, align 4
  store i32 20, i32* %7, align 4
  %9 = load i32, i32* %6, align 4
  %10 = load i32, i32* %7, align 4
  %11 = add nsw i32 %9, %10
  %12 = add nsw i32 %11, 10
  store i32 %12, i32* %8, align 4
  ret i32 0
}

attributes #0 = { noinline nounwind optnone ssp uwtable &quot;correctly-rounded-divide-sqrt-fp-math&quot;=&quot;false&quot; &quot;disable-tail-calls&quot;=&quot;false&quot; &quot;less-precise-fpmad&quot;=&quot;false&quot; &quot;no-frame-pointer-elim&quot;=&quot;true&quot; &quot;no-frame-pointer-elim-non-leaf&quot; &quot;no-infs-fp-math&quot;=&quot;false&quot; &quot;no-jump-tables&quot;=&quot;false&quot; &quot;no-nans-fp-math&quot;=&quot;false&quot; &quot;no-signed-zeros-fp-math&quot;=&quot;false&quot; &quot;no-trapping-math&quot;=&quot;false&quot; &quot;stack-protector-buffer-size&quot;=&quot;8&quot; &quot;target-cpu&quot;=&quot;penryn&quot; &quot;target-features&quot;=&quot;+cx16,+fxsr,+mmx,+sahf,+sse,+sse2,+sse3,+sse4.1,+ssse3,+x87&quot; &quot;unsafe-fp-math&quot;=&quot;false&quot; &quot;use-soft-float&quot;=&quot;false&quot; }

!llvm.module.flags = !{!0, !1, !2, !3, !4, !5, !6}
!llvm.ident = !{!7}

!0 = !{i32 1, !&quot;Objective-C Version&quot;, i32 2}
!1 = !{i32 1, !&quot;Objective-C Image Info Version&quot;, i32 0}
!2 = !{i32 1, !&quot;Objective-C Image Info Section&quot;, !&quot; __DATA,__ objc_imageinfo,regular,no_dead_strip&quot;}
!3 = !{i32 4, !&quot;Objective-C Garbage Collection&quot;, i32 0}
!4 = !{i32 1, !&quot;Objective-C Class Properties&quot;, i32 64}
!5 = !{i32 1, !&quot;wchar_size&quot;, i32 4}
!6 = !{i32 7, !&quot;PIC Level&quot;, i32 2}
!7 = !{!&quot;Apple LLVM version 10.0.0 (clang-1000.11.45.2)&quot;}
//什么鬼东西</code></pre><p>2.memory: 内存格式<br>3.bitcode: 二进制格式,扩展名<code>.bc</code></p>
<blockquote>
<p>clang -c -emit-llvm main.m</p>
</blockquote>
<h3 id="IR基本语法"><a href="#IR基本语法" class="headerlink" title="IR基本语法"></a>IR基本语法</h3><ul>
<li>注释以分号<code>;</code>开头</li>
<li>全局标识符以<code>@</code>开头,局部标识符以<code>%</code>开头</li>
<li><code>alloca</code>在当前函数栈帧中分配内存</li>
<li><code>i32</code>,32bit,4个字节的意思</li>
<li><code>align</code>,内存对齐</li>
<li><code>store</code>,写入数据</li>
<li><code>load</code>,读取数据</li>
</ul>
<p><strong>–EOF–</strong></p>
<!--kg-card-end: markdown-->]]></content>
      <categories>
        <category>LLVM</category>
      </categories>
  </entry>
  <entry>
    <title>封装CoreImage</title>
    <url>/package-coreimage/</url>
    <content><![CDATA[<p> <strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>战舰</title>
    <url>/battleship/</url>
    <content><![CDATA[<p> <strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>同步的方式编写异步代码</title>
    <url>/sync-way-code-async-code/</url>
    <content><![CDATA[<p>代码来自泊学</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>Enum表示TableView的数据源</title>
    <url>/enum-express-tableview-datasource/</url>
    <content><![CDATA[<figure class="kg-card kg-image-card"><img class="kg-image" data-src="https://img.hacpai.com/bing/20180330.jpg?imageView2/1/w/960/h/520/interlace/1/q/100"></figure><!--kg-card-end: image--><!--kg-card-begin: code-->

<pre><code>//
// SettingTableViewController.swift


import UIKit

protocol SettingViewControllerDelegate: class {
    func controllerDidChangeDateMode(controller: SettingTableViewController)
    func controllerDidChangeTemperatureMode(controller: SettingTableViewController)
}

class SettingTableViewController: UITableViewController {

    weak var changeDelegate: SettingViewControllerDelegate?
    override func viewDidLoad() {
        super.viewDidLoad()
        tableView.rowHeight = 44
    }
}

extension SettingTableViewController {
    private enum Section: Int {
        case date
        case temperature

        var numberOfRows: Int {
            return 2
        }

        static var count: Int {
            return Section.temperature.rawValue + 1
        }
    }

    override func numberOfSections(in tableView: UITableView) -&gt; Int {
        return Section.count
    }

    override func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int {
        guard let section = Section(rawValue: section) else {
            fatalError(&quot;未知section索引&quot;)
        }
        return section.numberOfRows
    }

    override func tableView(_ tableView: UITableView, titleForHeaderInSection section: Int) -&gt; String? {
        if section == 0 {
            return &quot;Date format&quot;
        }
        return &quot;Temperature unit&quot;
    }

    override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {
        guard let cell = tableView.dequeueReusableCell(withIdentifier: SettingTableViewCell.reuseIdentifier, for: indexPath) as? SettingTableViewCell else {
            fatalError(&quot;未知的tableViewCell&quot;)
        }
        guard let section = Section(rawValue: indexPath.section) else {
            fatalError(&quot;未知的section&quot;)
        }
        switch section {
        case .date:
            cell.label.text = (indexPath.row == 0) ? &quot;Fri, 01 December&quot; : &quot;F, 12/01&quot;
            let timeMode = UserDefaults.dateMode()
            if indexPath.row == timeMode.rawValue {
                cell.accessoryType = .checkmark
            } else {
                cell.accessoryType = .none
            }
        case .temperature:
            cell.label.text = (indexPath.row == 0) ? &quot;Celcius&quot; : &quot;Fahrenheit&quot;
            let temperatureMode = UserDefaults.temperatureMode()
            if indexPath.row == temperatureMode.rawValue {
                cell.accessoryType = .checkmark
            } else {
                cell.accessoryType = .none
            }
        }
        return cell
    }

    override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        tableView.deselectRow(at: indexPath, animated: true)
        guard let section = Section(rawValue: indexPath.section) else {
            fatalError(&quot;未知的section索引&quot;)
        }
        switch section {
            case .date:
                let dateMode = UserDefaults.dateMode()
                guard indexPath.row != dateMode.rawValue else { return }
                if let newMode = DateMode(rawValue: indexPath.row) {
                    UserDefaults.setDateMode(to: newMode)
                }
                changeDelegate?.controllerDidChangeDateMode(controller: self)
            case .temperature:
                let temperatureMode = UserDefaults.temperatureMode()
                guard indexPath.row != temperatureMode.rawValue else { return }
                if let newMode = TemperatureMode(rawValue: indexPath.row) {
                    UserDefaults.setTemperatureMode(to: newMode)
                }
                changeDelegate?.controllerDidChangeTemperatureMode(controller: self)
        }
        let sections = IndexSet(integer: indexPath.section)
        tableView.reloadSections(sections, with: .none)
    }
}</code></pre><!--kg-card-end: code-->

<p>提供一种思路</p>
<p>代码来自<a href="https://boxueio.com/" target="_blank" rel="noopener">泊学</a></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>反向代理</title>
    <url>/reverse-proxy/</url>
    <content><![CDATA[<pre><code>server {
    listen 80;
    listen 443 ssl;
    server_name localhost;

    ssl_certificate /etc/nginx/ssl/fullchain.cer;
    ssl_certificate_key /etc/nginx/ssl/unsplash.jingxuetao.com.key;

    location /api {
        rewrite ^.+api/?(.*)$ /$1 break;
        proxy_pass https://api.unsplash.com;
    }

    location /images {
        rewrite ^.+images/?(.*)$ /$1 break;
        proxy_pass https://images.unsplash.com;
    }

}</code></pre><!--kg-card-end: code-->

<p><strong>参考链接</strong></p>
<p><a href="https://www.cnblogs.com/gabrielchen/p/5066120.html" target="_blank" rel="noopener">https://www.cnblogs.com/gabrielchen/p/5066120.html</a><br><a href="https://www.jianshu.com/p/b34a57129d6c?from=timeline" target="_blank" rel="noopener">https://www.jianshu.com/p/b34a57129d6c?from=timeline</a></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>NGINX</category>
      </categories>
  </entry>
  <entry>
    <title>常用命令行</title>
    <url>/chang-yong-ming-ling-xing/</url>
    <content><![CDATA[<pre><code>find . -name &quot;*.gif&quot;|sed &apos;s/.gif//&apos;|xargs -n1 -I {} mv {}.gif {}.png //批量修改文件后缀名
sips -Z 75 *.png //批量修改文件像素
sudo python -m SimpleHTTPServer 80 //开启一个简单的服务器,用于网页访问文件夹内容.</code></pre><!--kg-card-end: code-->]]></content>
      <categories>
        <category>macOS</category>
      </categories>
  </entry>
  <entry>
    <title>Ghost博客支持emoji</title>
    <url>/ghost-blog-support-emoji/</url>
    <content><![CDATA[<p><a href="https://xiao.lu/solve-the-ghost-blog-can-not-display-emoji/" target="_blank" rel="noopener">原文链接</a></p>
<p>转载备忘</p>
<p>自从 Emoji 被推广开来，被越来越多的操作系统支持，变成了一种通用的表情符号，今天看到 Ghost 的官方博客文章中用了 Emoji，我也想试一下，发现自己文章中插入 Emoji 发表后不能显示。😭</p>
<p>Google 了一下，找到了问题，我的 Ghost 数据保存在 MySQL 数据库上，当时安装 MySQL 设置了 utf8 的字符集，需要改成 utf8mb4 才能支持存储 Emoji。</p>
<p>那么如何把当前 MySQL 的编码由 utf8 转换为 utf8mb4 呢？😶</p>
<p>首先，为了保险起见，务必先备份一下原来的数据库。</p>
<p>然后呢，确认一下 MySQL 的版本号，要高于 5.5.3。</p>
<p>第三步，修改 MySQL 的配置文件 my.cnf，加入下面的内容，如果之前有设置 utf8 字符集的内容，需要删除。</p>
<p>下面是我博客的<code>my.cnf</code>内容,系统是<code>CentOS7.2</code>,文件位置<code>/etc/my.cnf</code></p>
<!--kg-card-begin: code-->

<pre><code>[client]
socket=/var/lib/mysql/mysql.sock
# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0
# Settings user and group are ignored when systemd is used.
# If you need to run mysqld under a different user or group,
# customize your systemd unit file for mariadb according to the
# instructions in http://fedoraproject.org/wiki/Systemd
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci

[mysqld_safe]
log-error=/var/log/mariadb/mariadb.log
pid-file=/var/run/mariadb/mariadb.pid

[client]
default-character-set=utf8mb4
[mysql]
default-character-set=utf8mb4
#
# include all files from the config directory
#
!includedir /etc/my.cnf.d</code></pre><!--kg-card-end: code-->

<p>第四步，重启 MySQL 服务，并确认变更</p>
<!--kg-card-begin: code-->

<pre><code>#登录 MySQL（需要 MySQL root 密码）
mysql -uroot -p
mysql&gt; SHOW VARIABLES WHERE Variable_name LIKE &apos;character\_set\_%&apos; OR Variable_name LIKE &apos;collation%&apos;;
+--------------------------+--------------------+
| Variable_name | Value |
+--------------------------+--------------------+
| character_set_client | utf8mb4 |
| character_set_connection | utf8mb4 |
| character_set_database | utf8mb4 |
| character_set_filesystem | binary |
| character_set_results | utf8mb4 |
| character_set_server | utf8mb4 |
| character_set_system | utf8 |
| collation_connection | utf8mb4_unicode_ci |
| collation_database | utf8mb4_unicode_ci |
| collation_server | utf8mb4_unicode_ci |
+--------------------------+--------------------+
10 rows in set (0.00 sec)</code></pre><!--kg-card-end: code-->

<p>第五步，修改数据库和数据表的编码格式。</p>
<!--kg-card-begin: code-->

<pre><code>#选择数据库，database-name 替换为你自己的数据库名
mysql&gt; use database-name
#对于 Ghost 貌似修改这两处就行了
mysql&gt; ALTER DATABASE ghost CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci;
mysql&gt; ALTER TABLE posts CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</code></pre><!--kg-card-end: code-->

<p>然后就支持emoji了.🙂🙂</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
  </entry>
  <entry>
    <title>Can&#39;t connect to local MySQL server through socket &#39;&#39; (2)</title>
    <url>/cant-connect-to-local-mysql-server-through-socket-2/</url>
    <content><![CDATA[<p>今天折腾Perfect服务端的时候,出现下面错误:</p>
<blockquote>
<p>Can’t connect to local MySQL server through socket ‘’ (2)</p>
</blockquote>
<p>然后各种Google,各种试错.最后在这篇文章中看到了<code>IP</code>这个字眼,突然灵感来了,直接把<code>locahost</code>改成<code>127.0.0.1</code>,然后成功了~</p>
<p>我了个大草,原来还能这么玩…</p>
<p>至于具体原因可以查看这篇文章<a href="http://www.jb51.net/article/50421.htm" target="_blank" rel="noopener">Localhost 与127.0.0.1和IP的区别是什么</a></p>
<p>于2017/9/12,我的博客支持emoji啦,😁😁😝</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
  </entry>
  <entry>
    <title>博客开启HTTPS</title>
    <url>/blog-open-https/</url>
    <content><![CDATA[<h2 id="系统环境"><a href="#系统环境" class="headerlink" title="系统环境:"></a>系统环境:</h2><!--kg-card-begin: code-->

<pre><code>#nginx -v
nginx version: nginx/1.10.2
#openssl version
OpenSSL 1.0.1e-fips 11 Feb 2013
#cat /etc/redhat-release
CentOS Linux release 7.3.1611 (Core)</code></pre><!--kg-card-end: code-->
<h2 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h2><blockquote>
<p><a href="https://certbot.eff.org/" target="_blank" rel="noopener">Certbot</a>选择自己的操作系统以及服务器软件,按照说明安装即可.</p>
</blockquote>
<h2 id="安装方式二"><a href="#安装方式二" class="headerlink" title="安装方式二"></a>安装方式二</h2><blockquote>
<p><a href="https://github.com/Neilpang/acme.sh" target="_blank" rel="noopener">acme.sh</a>有中文文档,按照文档安装即可.</p>
</blockquote>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Ghost</category>
      </categories>
  </entry>
  <entry>
    <title>搭建博客遇到的问题</title>
    <url>/da-jian-bo-ke-yu-dao-de-wen-ti/</url>
    <content><![CDATA[<blockquote>
<p>操作系统版本: CentOS7.2</p>
</blockquote>
<h2 id="1-安装Nginx说找不到包"><a href="#1-安装Nginx说找不到包" class="headerlink" title="1. 安装Nginx说找不到包"></a>1. 安装Nginx说找不到包</h2><!--kg-card-begin: code-->

<pre><code>yum remove eprl-release
yum install eprl-release</code></pre><!--kg-card-end: code-->
<h2 id="2-安装MySQL有问题"><a href="#2-安装MySQL有问题" class="headerlink" title="2. 安装MySQL有问题"></a>2. 安装MySQL有问题</h2><!--kg-card-begin: code-->

<pre><code>CentOS7.2安装的是Mariadb,安装方式如下:
安装命令

yum -y install mariadb mariadb-server
安装完成MariaDB，首先启动MariaDB

systemctl start mariadb
设置开机启动

systemctl enable mariadb
接下来进行MariaDB的相关简单配置

mysql_secure_installation
首先是设置密码，会提示先输入密码

Enter current password for root (enter for none):&lt;–初次运行直接回车

设置密码

Set root password? [Y/n] &lt;– 是否设置root用户密码，输入y并回车或直接回车
New password: &lt;– 设置root用户的密码
Re-enter new password: &lt;– 再输入一次你设置的密码

其他配置

Remove anonymous users? [Y/n] &lt;– 是否删除匿名用户，回车

Disallow root login remotely? [Y/n] &lt;–是否禁止root远程登录,回车,

Remove test database and access to it? [Y/n] &lt;– 是否删除test数据库，回车

Reload privilege tables now? [Y/n] &lt;– 是否重新加载权限表，回车

初始化MariaDB完成，接下来测试登录

mysql -uroot -ppassword
完成。</code></pre><!--kg-card-end: code-->

<p><strong>–EOF–</strong></p>
<p>Photo by Brady Bellini on Unsplash</p>
]]></content>
  </entry>
  <entry>
    <title>人类的父类是动物</title>
    <url>/superclass-of-people-is-animal/</url>
    <content><![CDATA[<blockquote>
<p>慢慢的你长大了，人们说你理性了，冷漠了，那是因为他们不知道，你对这个世界的情感不是变淡了，而是变深了，深到海面以下五百米深蓝的地方，在海面泛起一两个炫目漂亮的水花，对你已毫无意义。</p>
</blockquote>
<p>在微博上看到上面一段话,大脑处于空闲状态,脑洞大开了一下.</p>
<p>上面例子可能是因为 折腾的次数多了,发现折腾并没有什么卵用.然后自然而然的就不折腾了.人也是动物,继承了动物的一些共有属性.→_→我的面向对象思想已经出神入化了.像一条被链子被栓着的狗一样,狗想挣脱链子,但是挣脱了N次,发现并挣脱不了.最后,即使被放开,也不会再想挣脱.</p>
<p>每个人都是一个对象,给每个对象的每个属性设置不同的值,就成了每一个不同的人. 这么说,TM人类就是new出来的.再这么说整个世界,也是被new World()出来的.当然这个new World()需要被一个变量引用一下,可以是全局变量,可以是局部变量.否则分分钟就被销毁了.虚拟机知道自己是虚拟机么?虚拟机肯定认为自己是一台完整的电脑.</p>
<p>人既然是人类的实例对象.那人类肯定可以重载父类的属性跟方法.属性不一样,造就了不同的人的非行为部分.像高,福,帅,矮,挫,穷.<br>方法不同表现为人的行为不同.这就是有些人不理解另一些人做法的原因.TM方法都不一样,结果怎么会相同.</p>
<p>这是不是就说明了,你以为的不一定是别人以为的.</p>
<blockquote>
<p>最后一段是重点,’你以为的不一定是别人以为的’</p>
</blockquote>
<p>脑洞结束</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Me</category>
      </categories>
  </entry>
  <entry>
    <title>又好久没有更新博客了</title>
    <url>/updated-my-blog-for-a-long-time-too/</url>
    <content><![CDATA[<p>好久没更新博客了.</p>
<p>一是没什么东西可以写,看一些大神写的博客那质量,简直没法玩了.</p>
<p>二是还是实在没什么东西可以写.</p>
<p>想的东西有点杂,下面乱写了.</p>
<p>原来编程因为兴趣,而工作了之后才感觉兴趣并没什么卵用,最终还是钱.</p>
<p>几十天之前,前公司刚招了一个前端,结果第二天就走了,是因为学历问题.当技术总监跟boss说那个人走了的时候,boss就”哦”了一句…TM,当时我就笑喷了.这老板真是可以的.你他妈倒是问问什么原因啊!!!就TM’哦’了一句,当员工是什么了.也是比较服气.</p>
<p>因为各种原因,有个人原因,有外部原因.原来还想着公司不辞我,我肯定不会辞职.现在说这些好像是婊子给自己立牌坊.</p>
<p>前公司人事人挺好,发现我的问题,没有跟任何人说.</p>
<p>在前公司因为经验不够,导致项目延期了好长时间.给人一种不靠谱的感觉.继续留在那的话得花好长时间才能让人改变这种印象.算了,也懒得让人改变了.毕竟自己靠不靠谱自己说的算,不是么.</p>
<p>HTML5带的播放器样式太TM难看了,换一个.</p>
<p>现在凌晨3:13,还不打算睡.</p>
<p>难看就难看吧,折腾了几个小时,没弄出来.就这样吧.</p>
<p>现在凌晨3:12,打算整点东西喝.</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Me</category>
      </categories>
  </entry>
  <entry>
    <title>好久没更新博客了</title>
    <url>/updated-my-blog-for-a-long-time/</url>
    <content><![CDATA[<p>此人已死.有事烧纸.小事招魂.大事挖坟.</p>
<p>联系方式:43BA5BBCBD7622A060509FB1B1D96663</p>
]]></content>
  </entry>
  <entry>
    <title>项目上架问题总结</title>
    <url>/summary-of-project-problems/</url>
    <content><![CDATA[<h3 id="定位问题"><a href="#定位问题" class="headerlink" title="定位问题"></a>定位问题</h3><!--kg-card-begin: code-->

<pre><code>using background location services must provide a reason that clarifies the purpose of the use, using mechanisms described in the Human Interface Guidelines</code></pre><!--kg-card-end: code-->

<p>这个原因主要是向用于请求定位权限时,要说明原因.</p>
<p>解决方法<br>在info.plist文件中设置下面两个字段</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/c/fe/2ec9f27f3f7b9e19f7afe80f53710.png"></p>
<!--kg-card-end: markdown-->
<h3 id="占位符问题"><a href="#占位符问题" class="headerlink" title="占位符问题"></a>占位符问题</h3><!--kg-card-begin: code-->

<pre><code>we found that your app and/or its metadata does not appear to include final content, which is not in compliance with the App Store Review Guidelines</code></pre><!--kg-card-end: code-->

<p>可能原因一:这个原因主要是图片的placeholder,当从服务器没有请求到图片时,显示的placeholder图片被苹果认为是半成品的APP<br>可能原因二:在上架项目的时候对于APP的介绍描述不清楚,能吹则吹,多写点,又死不了人.</p>
<p>解决方法<br>在服务器弄好完整的图片,让APP能请求到.多些应用的描述.</p>
<!--kg-card-begin: hr-->
<hr>
<!--kg-card-end: hr-->

<p>以上方法仅限于理论,因为需要上架的项目没有源码.</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>embedded dylibs/frameworks are only supported编译报错</title>
    <url>/embedded-dylibs-frameworks-are-only-supportedbian-yi-bao-cuo/</url>
    <content><![CDATA[<h3 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h3><!--kg-card-begin: code-->

<pre><code>ld: embedded dylibs/frameworks are only supported on iOS 8.0 and later (@rpath/Alamofire.framework/Alamofire) for architecture x86_64</code></pre><!--kg-card-end: code-->

<p>其实从名字大概也能猜出来,某个库支持的最低部署环境是8.0.</p>
<h3 id="修改方法"><a href="#修改方法" class="headerlink" title="修改方法"></a>修改方法</h3><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img class="kg-image" data-src="https://o3pxzuakz.qnssl.com/image/4/64/cbfb32287545352e67ba92d4ae471.png"></figure><!--kg-card-end: image-->

<p>我这应该修改成8.0</p>
<p>本文参考<a href="http://blog.csdn.net/xyxjn/article/details/42100425" target="_blank" rel="noopener">xyxjn的专栏</a></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>动态加载视图</title>
    <url>/dynamic-loading-view/</url>
    <content><![CDATA[<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ol>
<li>获取JSON文件路径</li>
<li>根据路径创建NSData对象</li>
<li>根据NSData对象对JSON进行序列化,得到一个数组</li>
<li>遍历数组,提取出<code>视图名</code>,<code>标题</code>,<code>图片名</code>,根据这三项创建视图,并用UINavigationViewController包裹起来,将navi添加到tabBarViewController中.</li>
</ol>
<h3 id="MainVCSettings-json文件"><a href="#MainVCSettings-json文件" class="headerlink" title="MainVCSettings.json文件"></a>MainVCSettings.json文件</h3><!--kg-card-begin: code-->

<pre><code>[
 {
    &quot;vcName&quot;: &quot;HomeTableViewController&quot;,
    &quot;title&quot;: &quot;首页&quot;,
    &quot;imageName&quot;: &quot;tabbar_home&quot;
 },
 {
     &quot;vcName&quot;: &quot;MessageTableViewController&quot;,
     &quot;title&quot;: &quot;消息&quot;,
     &quot;imageName&quot;: &quot;tabbar_message_center&quot;
 },
 {
 &quot;vcName&quot;: &quot;NullViewController&quot;,
 &quot;title&quot;: &quot;&quot;,
 &quot;imageName&quot;: &quot;&quot;
 },
 {
     &quot;vcName&quot;: &quot;DiscoverTableViewController&quot;,
     &quot;title&quot;: &quot;广场&quot;,
     &quot;imageName&quot;: &quot;tabbar_discover&quot;
 },
 {
     &quot;vcName&quot;: &quot;ProfileTableViewController&quot;,
     &quot;title&quot;: &quot;我&quot;,
     &quot;imageName&quot;: &quot;tabbar_profile&quot;
 }
 ]</code></pre><!--kg-card-end: code-->
<h3 id="具体实现代码"><a href="#具体实现代码" class="headerlink" title="具体实现代码"></a>具体实现代码</h3><!--kg-card-begin: code-->

<pre><code>//
// MainViewController.swift
// weibo
//
// Created by Adrift on 16/6/5.
// Copyright © 2016年 Adrift. All rights reserved.
//

import UIKit

class MainViewController: UITabBarController {

    //MARK: - 生命周期
    override func viewDidLoad() {
        super.viewDidLoad()
        //设置当前控制器对应的tabBar的颜色,iOS7之前如果设置了tintClor只有文字会变,而图片不会变
        tabBar.tintColor = UIColor.orangeColor()
        addChildViewControllers()
    }

    override func viewWillAppear(animated: Bool) {
        super.viewWillAppear(true)
        tabBar.addSubview(composeBtn)
        //计算宽度
        let width = UIScreen.mainScreen().bounds.width / CGFloat(viewControllers!.count)
        //创建 frame
        let rect = CGRect(x: 0, y: 0, width: width, height: tabBar.bounds.height)
        //设置 frame 跟 偏移量
        composeBtn.frame = CGRectOffset(rect, width * 2, 0)

    }

    //MARK: - 方法
    /**
     添加所有子控制器
     */
    func addChildViewControllers() {
        //获取json文件路径
        let path = NSBundle.mainBundle().pathForResource(&quot;MainVCSettings&quot;, ofType: &quot;json&quot;)
        //通过文件路径创建NSData
        if let tempPath = path {
            let jsonData = NSData(contentsOfFile: tempPath)
            do {
                //序列化
                let dictArr = try NSJSONSerialization.JSONObjectWithData(jsonData!, options: NSJSONReadingOptions.MutableContainers) as! [[String: String]]
                //遍历数组,并创建视图控制器
                for dict in dictArr {
                    addChildViewController(dict[&quot;vcName&quot;]!, title: dict[&quot;title&quot;]!, imageName: dict[&quot;imageName&quot;]!)
                }
            }catch{
                print(&quot;crash&quot;)
                //并添加到TabBarViewController
                addChildViewController(&quot;HomeTableViewController&quot;, title: &quot;首页&quot;, imageName: &quot;tabbar_home&quot;)
                addChildViewController(&quot;MessageTableViewController&quot;, title: &quot;消息&quot;, imageName: &quot;tabbar_message_center&quot;)
                addChildViewController(&quot;NullViewController&quot;, title: &quot;&quot;, imageName: &quot;&quot;)
                addChildViewController(&quot;DiscoverTableViewController&quot;, title: &quot;发现&quot;, imageName: &quot;tabbar_discover&quot;)
                addChildViewController(&quot;ProfileTableViewController&quot;, title: &quot;我的&quot;, imageName: &quot;tabbar_profile&quot;)
            }
        }
    }

    /**
     将navigationViewController 添加到 TabBarViewController

     - parameter childController: 子控制图
     - parameter title: 标题
     - parameter imageName: 非高亮图片名称
     */
    private func addChildViewController(childControllerName: String, title: String, imageName: String) {
        //获取命名空间
        let speaceName = NSBundle.mainBundle().infoDictionary![&quot;CFBundleExecutable&quot;] as! String

        //通过字符串转换为类
        let cls:AnyClass? = NSClassFromString(speaceName + &quot;.&quot; + childControllerName)

        //通过类创建对象
        let vcCls = cls as! UIViewController.Type
        let vc = vcCls.init()

// 设置首页
        vc.tabBarItem.image = UIImage(named: imageName)
        vc.tabBarItem.selectedImage = UIImage(named: imageName + &quot;_highlighted&quot;)
        vc.title = title
        //2.给首页包装一个导航器
        let navi = UINavigationController()
        navi.addChildViewController(vc)
        //3.将导航控制器添加到当前控制器
        addChildViewController(navi)
    }

    func composeBtnClick() {
        print(&quot;被点击...&quot;)
    }

    //MARK: - 懒加载
    private lazy var composeBtn:UIButton = {

        let button = UIButton()

        //设置button图片
        button.setImage(UIImage(named: &quot;tabbar_compose_icon_add&quot;), forState: UIControlState.Normal)
        button.setImage(UIImage(named: &quot;tabbar_compose_icon_add_highlighted&quot;), forState: UIControlState.Highlighted)

        //设置button背景图片
        button.setBackgroundImage(UIImage(named: &quot;tabbar_compose_button&quot;), forState: UIControlState.Normal)
        button.setBackgroundImage(UIImage(named: &quot;tabbar_compose_button_highlighted&quot;), forState: UIControlState.Highlighted)

        //添加监听事件
        button.addTarget(self, action: #selector(MainViewController.composeBtnClick), forControlEvents: UIControlEvents.TouchUpInside)

        return button
    }()
}</code></pre><!--kg-card-end: code-->

<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Swift</category>
      </categories>
  </entry>
  <entry>
    <title>Ghost博客设置邮件发送服务</title>
    <url>/ghost-set-email-service/</url>
    <content><![CDATA[<p>自从安装Ghost博客之后,邮件服务都是被弃用的…闲的无聊,百度了一下…</p>
<!--kg-card-begin: code-->

<pre><code>mail: {
    transport: &apos;SMTP&apos;,
    host: &apos;smtp.qq.com&apos;,
    fromaddress: &apos;vip@qq.com&apos;,
    options: {
        port: 465,
        service: &apos;QQ&apos;,
        auth: {
            user: &apos;vip@qq.com&apos;,
            pass: &apos;abcdefg123456789&apos;
        }
    }
}</code></pre><!--kg-card-end: code-->

<p>设置之后可以发QQ邮件,如果是其他邮箱,修改一下host就可以了.</p>
<p>本文参考:<a href="http://www.kisshc.com/backup/" target="_blank" rel="noopener">Ghost博客系统数据库自动邮件备份</a></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Ghost</category>
      </categories>
  </entry>
  <entry>
    <title>github上误删远程库解决方法</title>
    <url>/github-mistakenly-delete-remote-library-solution/</url>
    <content><![CDATA[<p>迷你码农遇到的个性化问题.遇到这个问题还得上网查,说明对Git不了解.有时间看看廖雪峰的<a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="noopener">Git教程</a>.</p>
<h3 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h3><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img class="kg-image" alt="报错信息" data-src="https://o3pxzuakz.qnssl.com/image/d/77/18cb880e3e602afddb9c9ece95d52.png"></figure><!--kg-card-end: image-->
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><ol>
<li>在Github Desktop客户端<code>右击项目</code>,然后<code>Open in Terminal</code></li>
<li>输入命令:<code>ls -al</code>,会看到.git文件夹</li>
<li>输入命令:<code>cd .git</code>,打开.git文件夹</li>
<li>输入命令:<code>ls -al</code>,会看到config文件</li>
<li>输入命令:<code>vim config</code>,打开config文件</li>
<li>按键盘<code>下</code>键,将光标移动到<code>[remote &quot;origin&quot;]</code>这行,按键盘<code>i</code>键进入插入模式.</li>
<li>按<code>delete</code>键删除包括本行在内的三行</li>
<li>删除完之后,按<code>Esc</code>键,退出编辑模式.然后英文状态下输入<code>shift+:</code>,输入<code>wq</code>,保存退出.</li>
<li>将<code>Github Desktop</code>完全退出重新打开,现在就能<code>Sync</code>了.</li>
</ol>
<p>参考链接:<a href="http://www.jamesrobertson.eu/blog/2013/mar/17/solved-error-repository-not-found.html" target="_blank" rel="noopener">Solved: ERROR: Repository not found</a></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Git</category>
      </categories>
  </entry>
  <entry>
    <title>OC根据分隔符分隔字符串</title>
    <url>/oc-according-to-symbol-split-string/</url>
    <content><![CDATA[<p>同学前几天面试面到了这个题,毕竟闷了半天才闷出来.记录一下省的忘了…</p>
<p>NSString+Category.h文件</p>
<!--kg-card-begin: code-->

<pre><code>#import &lt;Foundation/Foundation.h&gt;

@interface NSString (Category)

/**
 * 根据分隔符,分隔字符串
 *
 * @param symbol 分隔符
 *
 * @return 由被分隔完的字串组成的数组
 */
- (NSArray *)splitStringWithSymbol:(NSString *)symbol;

@end</code></pre><!--kg-card-end: code-->

<p>NSString+Category.m文件</p>
<!--kg-card-begin: code-->

<pre><code>#import &quot;NSString+Category.h&quot;

@implementation NSString (Category)

- (NSArray *)splitStringWithSymbol:(NSString *)symbol {

    if (!self || [self isEqualToString:@&quot;&quot;] || !symbol || [self isEqualToString:@&quot;&quot;]) {
        NSException *e = [NSException exceptionWithName:@&quot;NullPointerException&quot; reason:@&quot;self and symbol can&apos;t be nil or @\&quot;\&quot;&quot; userInfo:nil];
        @throw e;
    }

    NSMutableArray *mutableArr = [NSMutableArray new];
    NSInteger length = symbol.length;
    NSString *tempStr = nil;

    for (int startIndex = 0, endIndex = 0; endIndex &lt;= self.length - length; endIndex++) {

        tempStr = [self substringWithRange:NSMakeRange(endIndex, length)];
        if ([tempStr isEqualToString:symbol]) {
            NSString *splitedString = [self substringWithRange:NSMakeRange(startIndex, endIndex - startIndex)];
            if (splitedString &amp;&amp; ![splitedString isEqualToString:@&quot;&quot;]) {
                [mutableArr addObject:splitedString];
            }
            startIndex = endIndex + (int)length;
        } else if (endIndex == self.length - length){
            NSString *splitedString = [self substringWithRange:NSMakeRange(startIndex, endIndex - startIndex + length)];
            if (splitedString &amp;&amp; ![splitedString isEqualToString:@&quot;&quot;]) {
                [mutableArr addObject:splitedString];
            }
        }

    }

    return [mutableArr copy];
}
@end</code></pre><!--kg-card-end: code-->

<p>以上代码有个问题,当字符串是<code>,asdf,,123</code>,分隔字符是<code>,</code>,分隔结果是<code>(asdf,123)</code>,而不是<code>(asdf,(前面一个是数组的逗号),123)</code>.<br>试了一下官方的<code>componentsSeparatedByString</code>方法,相同的字符串跟分隔符,输出结果是<code>(&quot;&quot;,asdf,&quot;&quot;,123)</code>,连是否是<code>@&quot;&quot;</code>都没判断.Java当中实验的结果跟OC结果相同.官方方法都这样,我想我是想多了.</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>自定义搜索框</title>
    <url>/custom-searchbar/</url>
    <content><![CDATA[<h3 id="封装的几种方法"><a href="#封装的几种方法" class="headerlink" title="封装的几种方法"></a>封装的几种方法</h3><ol>
<li>分类:UITextField/UISearchBar</li>
<li>自定义控件</li>
<li>工具类</li>
</ol>
<p>从上到下优先度依次降低.</p>
<h3 id="用哪种方式封装"><a href="#用哪种方式封装" class="headerlink" title="用哪种方式封装"></a>用哪种方式封装</h3><p>通过分类,如果通过分类[UITextField searchBar]方法名跟类名明显对不上号;[UISearchBar searchBar]返回结果是一个UITextField,跟类名也对不上.所以我们需要自定控件,自定义控件就需要继承UITextField.</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>== CTSearchBar.h 文件==</p>
<!--kg-card-begin: code-->

<pre><code>#import &lt;UIKit/UIKit.h&gt;

@interface CTSearchBar : UITextField
+ (instancetype)searchBar;
@end</code></pre><!--kg-card-end: code-->

<p>CTSearchBar.m</p>
<!--kg-card-begin: code-->

<pre><code>#import &quot;CTSearchBar.h&quot;

@implementation CTSearchBar

- (instancetype)initWithFrame:(CGRect)frame {
    if (self = [super initWithFrame:frame]) {
        self.font = [UIFont systemFontOfSize:15];
        self.placeholder = @&quot;请输入搜索内容&quot;;
        self.clearsOnBeginEditing = YES;
        self.clearButtonMode = UITextFieldViewModeAlways;

        UIImage *image = [UIImage imageNamed:@&quot;searchbar_textfield_search_icon&quot;];
        UIImageView *searchIcon = [[UIImageView alloc] initWithImage:image];
        searchIcon.width = 30;
        searchIcon.height = 30;
        searchIcon.contentMode = UIViewContentModeCenter;

        self.leftView = searchIcon;
        self.leftViewMode = UITextFieldViewModeAlways;
    }
    return self;
}

+ (instancetype)searchBar {
    return [[self alloc] init];
}
@end</code></pre><!--kg-card-end: code-->
<h3 id="调用方式"><a href="#调用方式" class="headerlink" title="调用方式"></a>调用方式</h3><!--kg-card-begin: code-->

<pre><code>- (void)viewDidLoad {
    [super viewDidLoad];

    UITextField *searchBar = [CTSearchBar searchBar];
    searchBar.width = 500;
    searchBar.height = 35;
    self.navigationItem.titleView = searchBar;
}</code></pre><!--kg-card-end: code-->

<p>上面代码中<code>searchBar.width = 500;</code>这种方式是因为我给UIView做了一个分类,所以可以直接赋值.详见:<a href="https://jingxuetao.com/by-category-to-make-uiview-convenient-layout/">通过Category让UIView更方便的布局</a></p>
<p>以上仅提供简单思路,还可以封装更加复杂的搜索框,像新浪微博的.</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>用分类自定义UIBarButtonItem</title>
    <url>/use-category-define-uibarbuttonitem/</url>
    <content><![CDATA[<blockquote>
<p>原因：</p>
</blockquote>
<ol>
<li>项目中多次用到自定义UIBarButtonItem，所以需要抽取出来</li>
<li>代码该干什么就干什么，因为这段代码是自定义。UIBarButtonItem，所以应该由UIBarButtonItem做。所以创建一个分类。</li>
<li>命名习惯，代码规范。要用[UIBarButtonItem itemWith…]这种形式。</li>
</ol>
<h3 id="自定义UIBarButtonItem"><a href="#自定义UIBarButtonItem" class="headerlink" title="自定义UIBarButtonItem"></a>自定义UIBarButtonItem</h3><p>UIBarButtonItem+Category.h文件</p>
<!--kg-card-begin: code-->

<pre><code>#import &lt;UIKit/UIKit.h&gt;

@interface UIBarButtonItem (Category)
+ (NSArray *)itemWithTarget:(id)target action:(SEL)action image:(NSString *)image lighlightImage:(NSString *)lighlightImage;
@end</code></pre><!--kg-card-end: code-->

<p>UIBarButtonItem+Category.m文件</p>
<!--kg-card-begin: code-->

<pre><code>#import &quot;UIBarButtonItem+Category.h&quot;

@implementation UIBarButtonItem (Category)

/**
 * 自定义一个UIBarButtomItem
 *
 * @param target 点击之后调用哪个对象
 * @param action 点击之后调用对象里面的哪个方法
 * @param image 普通状态下图片
 * @param lighlightImage 高亮状态下图片
 *
 * @return 创建完的一个UIBarButtomItem数组
 */
+ (NSArray *)itemWithTarget:(id)target action:(SEL)action image:(NSString *)image lighlightImage:(NSString *)lighlightImage {

    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    [button setImage:[UIImage imageNamed:image] forState:UIControlStateNormal];
    [button setImage:[UIImage imageNamed:lighlightImage] forState:UIControlStateHighlighted];
    [button addTarget:target action:action forControlEvents:UIControlEventTouchUpInside];
    button.size = button.currentImage.size;

    UIBarButtonItem *buttonItem = [[UIBarButtonItem alloc]initWithCustomView:button];
    UIBarButtonItem *speaceItem = [[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFixedSpace target:nil action:nil];
    speaceItem.width = -5;

    return @[speaceItem,buttonItem];
}

@end</code></pre><!--kg-card-end: code-->
<h3 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h3><p>在ViewController调用或者在自定义的UINavigationController的push方法里面调用。</p>
<!--kg-card-begin: code-->

<pre><code>//ViewController调用
self.navigationItem.leftBarButtonItems = [UIBarButtonItem itemWithTarget:self action:@selector(back) image:@&quot;back_icon_red&quot; lighlightImage:@&quot;back_icon_red&quot;];
//自定义UINavigationController的push方法调用
viewController.navigationItem.leftBarButtonItems = [UIBarButtonItem itemWithTarget:self action:@selector(back) image:@&quot;back_icon_red&quot; lighlightImage:@&quot;back_icon_red&quot;];</code></pre><!--kg-card-end: code-->

<p>注意：action方法写在ViewController或自定义UINavigationController里面。</p>
<p>当然还可以在分类里做其他自定义的样式。</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>统一设置UINavigationController左上角图标</title>
    <url>/unified-set-navi-upper-left-corner-icon/</url>
    <content><![CDATA[<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>通过工厂方法，然后在需要左上角显示图标的ViewController的viewDidLoad方法调用。代码如下：</p>
<p>Factory.h文件</p>
<!--kg-card-begin: code-->

<pre><code>#import &lt;Foundation/Foundation.h&gt;

@interface Factory : NSObject
+ (void)addBackButton:(UIViewController *)viewController;
@end
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">==Factory.m文件==</span><br></pre></td></tr></table></figure>

#import &quot;Factory.h&quot;

@implementation Factory
+ (void)addBackButton:(UIViewController *)viewController{
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    [button setImage:[UIImage imageNamed:@&quot;community_highlight&quot;] forState:UIControlStateNormal];
    [button setImage:[UIImage imageNamed:@&quot;community_highlight&quot;] forState:UIControlStateHighlighted];
    CGRect frame = button.frame;
    frame.size = button.currentImage.size;
    button.frame = frame;
    UIBarButtonItem *buttonItem = [[UIBarButtonItem alloc]initWithCustomView:button];
    UIBarButtonItem *speaceItem = [[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFixedSpace target:nil action:nil];
    speaceItem.width = -5;
    viewController.navigationItem.leftBarButtonItems = @[speaceItem,buttonItem];
}
@end
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">### 方法二</span><br><span class="line">这种方法是通过实现UINavigationController的pushViewController方法，拦截所有push进来的viewController，然后对其进行设置。代码如下：</span><br><span class="line"></span><br><span class="line">==BaseNavigationController.h文件==</span><br></pre></td></tr></table></figure>

#import &lt;UIKit/UIKit.h&gt;

@interface BaseNavigationController : UINavigationController

@end
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">==BaseNavigationController.m文件==</span><br></pre></td></tr></table></figure>

#import &quot;BaseNavigationController.h&quot;

@interface BaseNavigationController ()

@end

@implementation BaseNavigationController

- (void)addBackButton:(UIViewController *)viewController{
    if (self.viewControllers.count &gt; 0) {
        viewController.hidesBottomBarWhenPushed = YES;

        UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
        [button setImage:[UIImage imageNamed:@&quot;back_icon_red&quot;] forState:UIControlStateNormal];
        [button setImage:[UIImage imageNamed:@&quot;back_icon_red&quot;] forState:UIControlStateHighlighted];
        [button addTarget:self action:@selector(back) forControlEvents:UIControlEventTouchUpInside];
        button.size = button.currentImage.size;
        UIBarButtonItem *buttonItem = [[UIBarButtonItem alloc]initWithCustomView:button];
        UIBarButtonItem *speaceItem = [[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFixedSpace target:nil action:nil];
        speaceItem.width = -5;
        viewController.navigationItem.leftBarButtonItems = @[speaceItem,buttonItem];
    }
}

- (void)back{
    [self popViewControllerAnimated:YES];
}

- (void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated{
    NSLog(@&quot;push&quot;);
    [self addBackButton:viewController];
    [super pushViewController:viewController animated:animated];
}

#pragma -mark 生命周期
- (void)viewDidLoad {
    [super viewDidLoad];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}
@end
```
&gt; 注意：

1. 用方法一如果某个viewController需要单独设置navigationItem的图标，则在ViewController的viewDidLoad方法里设置即可。
2. 用了方法二如果在push之前调用设置view样式有关的方法，则先调用viewDidLoad方法，然后调用push方法。这时如果在viewDidLoad方法里设置navigationItem的图标将跟push方法拦截viewController设置的效果一样。

&gt; 所谓的拦截，大部分都是通过自定义类，然后重写自带方法实现的。

**--EOF--**</code></pre><!--kg-card-end: code-->]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>通过Category让UIView更方便的布局</title>
    <url>/tong-guo-categoryrang-uiviewgeng-fang-bian-de-bu-ju/</url>
    <content><![CDATA[<p>之前我们给一个控件设置宽高或者位置的时候会用下面代码：</p>
<!--kg-card-begin: code-->

<pre><code>UIView *view = [UIView new];
CGRect frame = view.frame;
frame.size.width = 100;
view.frame = frame;</code></pre><!--kg-card-end: code-->

<p>上面方式很麻烦，不解释。下面是对UIView的分类，方便了对控件的布局：<br>UIView+Category.h文件</p>
<!--kg-card-begin: code-->

<pre><code>#import &lt;UIKit/UIKit.h&gt;

@interface UIView (Extension)
@property (nonatomic,assign) CGFloat x;
@property (nonatomic,assign) CGFloat y;
@property (nonatomic,assign) CGFloat width;
@property (nonatomic,assign) CGFloat height;
@property (nonatomic,assign) CGSize size;
@property (nonatomic,assign) CGPoint origin;
//- (void)setX:(CGFloat)x;
//- (CGFloat)x;
//- (void)setY:(CGFloat)y;
//- (CGFloat)y;
//- (void)setWidth:(CGFloat)width;
//- (CGFloat)width;
//- (void)setHeight:(CGFloat)height;
//- (CGFloat)height;
//- (void)setOrigin:(CGPoint)origin;
//- (CGPoint)origin;
//- (void)setSize:(CGSize)size;
//- (CGSize)size;
@end</code></pre><!--kg-card-end: code-->

<p>UIView+Category.m文件</p>
<!--kg-card-begin: code-->

<pre><code>#import &quot;UIView+Category.h&quot;

@implementation UIView (Extension)
- (void)setX:(CGFloat)x {
    CGRect frame = self.frame;
    frame.origin.x = x;
    self.frame = frame;
}

- (CGFloat)x {
    return self.frame.origin.x;
}

- (void)setY:(CGFloat)y {
    CGRect frame = self.frame;
    frame.origin.y = y;
    self.frame = frame;
    self.frame = frame;
}

- (CGFloat)y {
    return self.frame.origin.y;
}

- (void)setWidth:(CGFloat)width {
    CGRect frame = self.frame;
    frame.size.width = width;
    self.frame = frame;
}

- (CGFloat)width {
    return self.frame.size.width;
}

- (void)setHeight:(CGFloat)height {
    CGRect frame = self.frame;
    frame.size.height = height;
    self.frame = frame;
}

- (CGFloat)height {
    return self.frame.size.height;
}

- (void)setOrigin:(CGPoint)origin {
    CGRect frame = self.frame;
    frame.origin = origin;
    self.frame = frame;
}

- (CGPoint)origin {
    return self.frame.origin;
}

- (void)setSize:(CGSize)size {
    CGRect frame = self.frame;
    frame.size = size;
    self.frame = frame;
}

- (CGSize)size {
    return self.frame.size;
}
@end</code></pre><!--kg-card-end: code-->

<p>现在就可以通过下面方式对UIView进行布局了：</p>
<!--kg-card-begin: code-->

<pre><code>UIView *view = [UIView new];
view.width = 100;
view.height = 100;
view.x = 100;
view.y = 100;
//或者
view.origin = CGPointMake(100, 100);
view.size = CGSizeMake(100, 100);</code></pre><!--kg-card-end: code-->

<p>最后你可能有疑问，category中不是不能定义属性么？即使可以定义属性，不应该用runtime来实现setter跟getter方法么？</p>
<ol>
<li>category中的属性不能自动生成实例变量（类似:_xxx），所以我们有时会看到通过runtime的方式将变量绑定到实例上。</li>
<li>上面例子，定义属性为了生成setter跟getter方法。没有用到任何有关<code>self.x</code>、<code>self.y</code>、<code>self.width</code>或者<code>_x</code>、<code>_y</code>这些自定义属性，都是通过UIView自带属性frame(self.frame)来实现给UIView设置布局，所以不需要用runtime。所以本例子不定义属性也可以，把属性注释掉，然后将下面方法取消注释，一样能用。</li>
</ol>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>为Ghost博客文章添加目录</title>
    <url>/add-dictionary-to-the-ghost/</url>
    <content><![CDATA[<h3 id="引入JS文件"><a href="#引入JS文件" class="headerlink" title="引入JS文件"></a>引入JS文件</h3><p>在default.hbs中引入js文件,下载<a href="https://github.com/idiotWu/jQuery-TOC/tree/master/dist" target="_blank" rel="noopener">TOC</a></p>
<!--kg-card-begin: code-->

<pre><code>//放在jQuery之后
&lt;script src=&quot;https://xxxxxx.com/jquery.toc.min.js&quot;&gt;&lt;/script&gt;</code></pre><!--kg-card-end: code-->
<h3 id="添加DIV"><a href="#添加DIV" class="headerlink" title="添加DIV"></a>添加DIV</h3><p>在post.hbs文件的<code>&lt;/main&gt;</code>标签之前添加下面代码</p>
<!--kg-card-begin: code-->

<pre><code>&lt;aside id=&quot;toc&quot;&gt;
    &lt;h4&gt;文章目录&lt;/h4&gt;
&lt;/aside&gt;</code></pre><!--kg-card-end: code-->
<h3 id="设置样式"><a href="#设置样式" class="headerlink" title="设置样式"></a>设置样式</h3><p>在博客的css文件里设置样式,代码如下:</p>
<!--kg-card-begin: code-->

<pre><code>#toc {
    font: 400 16px/1.8 &quot;Open Sans&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,sans-serif;
    position: fixed;
    display: none;
    left:50%;
    top: 50%;
    width: 180px;
    max-height: 100%;
    padding: 0 5px;
    overflow-y: auto;
}
#toc ol {
    margin: 0 0 0 1em;
    list-style: none;
    padding: 0;
}
#toc li {
    padding: 0;
    position: relative;
}
#toc li:before {
    border: 5px dashed transparent;
    border-left: 5px solid #57a3e8;
    position: absolute;
    left: -1em;
    top: .5em;
}
#toc li:before {
    content: &quot;&quot;;
    height: 0;
    width: 0;
    overflow: hidden;
}
#toc a {
    display: block;
    color: #6aa7c0;
    cursor: pointer;
    max-height: 2em;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
    text-decoration: none;
    transition: color .3s;
}
#toc a:hover {
    color: #F3A01E;
}
#toc h4 {
    padding-bottom: 0.25em;
    margin: .75em 0;
    border-bottom: 1px solid #b3b3b3;
    font-size: 18px;
    color: #3b3b3b;
    font-family: &quot;Open Sans&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,sans-serif;
}</code></pre><!--kg-card-end: code-->
<h3 id="初始化目录插件并动态的调整样式"><a href="#初始化目录插件并动态的调整样式" class="headerlink" title="初始化目录插件并动态的调整样式"></a>初始化目录插件并动态的调整样式</h3><p>在博客下的JS文件中添加下面代码:</p>
<!--kg-card-begin: code-->

<pre><code>$(document).ready(function() {
    //初始化插件
    $(&apos;#toc&apos;).initTOC({
        selector: &quot;h5, h6&quot;,
        scope: &quot;article&quot;,
        overwrite: false,
        prefix: &quot;toc&quot;
    });

    //动态设置样式,例如:滚动到一定程度之后隐藏目录
    var mar_left = $(&quot;.post&quot;).width() / 2 + 20;
    //var top = $(&quot;#toc&quot;).css(&quot;top&quot;); 这只能获取类似152px的字符串,下面才能获取值
    //var top = $(&quot;#toc&quot;).position().top;
    var top = $(window).height();
    $(&quot;#toc&quot;).css(&quot;top&quot;,top / 2 - (top / 4)+&quot;px&quot;);
    $(&quot;#toc ol&quot;).html(function(i,origText){
        return origText + &quot;&lt;li&gt;&lt;a id=&apos;scrollTop&apos; href=&apos;#&apos;&gt;返回顶部&lt;/a&gt;&lt;/li&gt;&quot;;
    });
    $(&quot;#toc&quot;).css({&quot;margin-left&quot;:mar_left+&quot;px&quot;});
    $(window).scroll(function(){
        var window_offset = $(window).scrollTop();
        var main_header_height = $(&quot;.main-header&quot;).height();
        var content_height = $(&quot;.content&quot;).height();
        if(window_offset &lt; main_header_height - 100) {
            $(&quot;#toc&quot;).hide();
            //下面的条件不能用 a&gt;x&gt;c这种形式,只能用&amp;&amp;.身为一个前端小白表示伤不起...
        }else if(window_offset &gt; main_header_height&amp;&amp;main_header_height+content_height - 500 &gt; window_offset) {
            $(&quot;#toc&quot;).show();
        }else{
            $(&quot;#toc&quot;).hide();
        }
    });
});</code></pre><!--kg-card-end: code-->

<p>以上就是我博客的文章目录添加步骤.前端有个好处就是<code>所见即所得</code>,慢慢折腾.^_^</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Ghost</category>
      </categories>
  </entry>
  <entry>
    <title>子类对象之间的强转</title>
    <url>/forced-conversion-between-sub-classes/</url>
    <content><![CDATA[<pre><code>#import &lt;Foundation/Foundation.h&gt;

@interface Tom : NSObject
@property (nonatomic,copy) NSString *name;
@property (nonatomic) NSInteger age;
@end

@implementation Tom
- (instancetype)initWithName:(NSString *)name andAge:(NSInteger)age {
    if (self = [self init]) {
        self.name = name;
        self.age =age;
    }
    return self;
}
@end

@interface Jerry : NSObject
@property (nonatomic) NSString *name;
@property (nonatomic) NSInteger age;
@end

@implementation Jerry
- (instancetype)initWithName:(NSString *)name andAge:(NSInteger)age {
    if (self = [self init]) {
        self.name = name;
        self.age =age;
    }
    return self;
}
@end

@interface Test : NSObject
@end

@implementation Test
+ (void)showName:(Tom *)tom {
    NSLog(@&quot;%@&quot;,tom.name);
}
+ (void)showNameWithKVC:(NSObject *)obj{
    NSString *name = [obj valueForKey:@&quot;name&quot;];
    NSLog(@&quot;%@&quot;,name);
}
@end

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        Tom *tom = [[Tom alloc]initWithName:@&quot;Tom&quot; andAge:10];
        Jerry *jerry = [[Jerry alloc]initWithName:@&quot;Jerry&quot; andAge:10];

        //可以通过强转的方式
        [Test showName:(Tom *)jerry];
        [Test showName:tom];

        //也可以通过KVC
        [Test showNameWithKVC:jerry];
        [Test showNameWithKVC:tom];

    }
    return 0;
}</code></pre><!--kg-card-end: code-->

<p><strong>–EOF–</strong></p>
]]></content>
  </entry>
  <entry>
    <title>配置CentOS密钥验证登录</title>
    <url>/config-centos-secretkey-authentication-login/</url>
    <content><![CDATA[<p>用密码登录SSH好不方便,并且安全性不高,为了提升安全性那我们就用密钥登录.</p>
<blockquote>
<p>本地环境:OS X,估计是Linux就可以.</p>
</blockquote>
<h3 id="1-在远程服务器上创建密钥对"><a href="#1-在远程服务器上创建密钥对" class="headerlink" title="1.在远程服务器上创建密钥对."></a>1.在远程服务器上创建密钥对.</h3><!--kg-card-begin: code-->

<pre><code># create key pair

[cent@dlp ~]$ ssh-keygen -t rsa

Generating public/private rsa key pair.
Enter file in which to save the key (/home/cent/.ssh/id_rsa): # 路径默认,直接回车

Created directory &apos;/home/cent/.ssh&apos;.
Enter passphrase (empty for no passphrase): # 设置密钥密码,直接回车，不用设置

Enter same passphrase again:#再次输入密码,直接回车

Your identification has been saved in /home/cent/.ssh/id_rsa.
Your public key has been saved in /home/cent/.ssh/id_rsa.pub.
The key fingerprint is:
38:f1:a4:6d:d3:0e:99:c8:fa:1d:1d:48:86:f0:fe:74 cent@dlp.server.world
The key&apos;s randomart image is:

[cent@dlp ~]$ mv ~/.ssh/id_rsa.pub ~/.ssh/authorized_keys#将id_rsa.pub中的公钥复制到authorized_keys中

[cent@dlp ~]$ chmod 600 ~/.ssh/authorized_keys #修改authorized_keys权限为拥有者可读写</code></pre><!--kg-card-end: code-->
<h3 id="2-将远程服务器上的私钥下载到本地用于登录远程服务器"><a href="#2-将远程服务器上的私钥下载到本地用于登录远程服务器" class="headerlink" title="2.将远程服务器上的私钥下载到本地用于登录远程服务器"></a>2.将远程服务器上的私钥下载到本地用于登录远程服务器</h3><p>以下是本地操作</p>
<!--kg-card-begin: code-->

<pre><code> [cent@www ~]$ mkdir ~/.ssh #创建文件夹

[cent@www ~]$ chmod 700 ~/.ssh #修改文件夹权限为拥有者可&apos;读,写,执行&apos;
# copy the secret key to local ssh directory

[cent@www ~]$ scp cent@10.0.0.30:/home/cent/.ssh/id_rsa ~/.ssh/ #将远程的私钥下载到本地,这要注意路径,如果用root登录的,路径是:/root/.ssh/id_rsa

cent@10.0.0.30&apos;s password: #输入远程服务器密码
id_rsa
[cent@www ~]$ ssh -i ~/.ssh/id_rsa cent@10.0.0.30 #现在就可以用这条命令登录远程服务器了

Enter passphrase for key &apos;/home/cent/.ssh/id_rsa&apos;: # 刚才密钥没设置密码,所以不会出现

Last login: Wed Jul 30 21:37:19 2014 from www.server.world
[cent@dlp ~]$ # 登录成功</code></pre><!--kg-card-end: code-->
<h3 id="3-简化登录"><a href="#3-简化登录" class="headerlink" title="3.简化登录"></a>3.简化登录</h3><p>本地机器执行下面代码:</p>
<!--kg-card-begin: code-->

<pre><code>vi ~/.ssh/config</code></pre><!--kg-card-end: code-->

<p>加入下面一段内容:</p>
<!--kg-card-begin: code-->

<pre><code>Host server #别名，域名缩写
    HostName jingxuetao.com #完整的域名
    User root #登录该域名使用的账号名
    PreferredAuthentications publickey #加不加都一样,SSH会优先密钥登录
    IdentityFile ~/.ssh/id_rsa #私钥文件的路径
    #删掉#号后面的中文,包括这句</code></pre><!--kg-card-end: code-->

<p>上面配置完了之后就可以通过<code>ssh server</code>或者<code>ssh jingxuetao.com</code>来登录远程服务器了.</p>
<h3 id="4-关闭密码验证登录"><a href="#4-关闭密码验证登录" class="headerlink" title="4.关闭密码验证登录"></a>4.关闭密码验证登录</h3><p>操作远程服务器</p>
<!--kg-card-begin: code-->

<pre><code>vi /etc/ssh/sshd_config</code></pre><!--kg-card-end: code-->

<p>找到<code>PasswordAuthentication</code>将其值改为<code>no</code></p>
<!--kg-card-begin: code-->

<pre><code>PasswordAuthentication no</code></pre><!--kg-card-end: code-->

<p>最后用<code>systemctl restart sshd</code>或者<code>service sshd restart</code>重启SSH服务</p>
<blockquote>
<p>好了,sshd_config文件中除了配置PasswordAuthentication这条之外其他的并不用配置,还是被注释状态</p>
</blockquote>
<p>保存到本地的密钥,最好备份到网盘一份.</p>
<p>本文参考:<a href="http://www.server-world.info/en/note?os=CentOS_7&p=ssh&f=4" target="_blank" rel="noopener">server-world</a></p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
  </entry>
  <entry>
    <title>深夜矫情</title>
    <url>/night-hypocritical/</url>
    <content><![CDATA[<p>前一天过得不踏实,心里不安,胡思乱想中想起博客名,就想起了高中,然后又想起了初中.然后百度了一下初中跟高中的官网,于是就找了一些图片,回忆一下我的初中跟高中.多图预警</p>
<h3 id="平度市朝-zhao-阳中学"><a href="#平度市朝-zhao-阳中学" class="headerlink" title="平度市朝(zhao)阳中学"></a>平度市朝(zhao)阳中学</h3><p>教学楼正面,教学楼从上面看是呈一个蝴蝶状的.初三的时候做课间操就是在教学楼前的广场上做.我们班在做操的时候是在广场中央,因为喇叭是安装在两边的教学楼上的并且对称,所以在做操的时候会有不一样的听觉效果.第一张图片是当时我们的朝阳中学的原图,下面三张图是后来的华侨高中.因为乡镇高中要迁往市里,所以就把我们学校给征收了,变成了华侨高中.好好的母校,被别人征去当高中,真是亏.</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/b/12/6691cc3c2226c662f69c11cf2a773.jpg"><br> <img alt data-src="https://pic.jingxuetao.com/image/6/ce/498ac686a12e1871981a304080f30.jpg"><br> <img alt data-src="https://pic.jingxuetao.com/image/7/33/58af8addd353e152a809ca194b343.jpg"><br> <img alt data-src="https://pic.jingxuetao.com/image/2/b2/a7e7e07c2dea8468175bd55c479b6.jpg"></p>
<!--kg-card-end: markdown-->

<p>教学楼背面.由于花钱不太节制,家里给的生活费第一个周花的差不多了,到了第二个周就只剩二三十块钱左右,二三十块钱要过五天,平均每天也就五六块钱.所以每当中午放学的时候,听着喇叭里放的<code>斯卡波罗集市</code>,走在这条回宿舍的路上(没钱,只能回宿舍,就着调料啃馒头:(),心里有点淡淡的忧伤.歌曲如下:</p>
<p>&lt;斯卡波罗集市-莎拉布莱曼&gt;</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/a/08/d944a589b50f71c52c66ed2304855.jpg"></p>
<!--kg-card-end: markdown-->

<p>操场,应该是初二的时候修起来的.之前都叫草场,杂草丛生,草有人那么高.</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/0/4c/5d22031ce6dddad5c2f616af6edc3.jpg"></p>
<!--kg-card-end: markdown-->

<p>左边是一个小操场,初二的时候做广播体操,早晨跑操都在这.右边是女生宿舍,当时好像没窗帘..</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/3/79/d4e97f33cb987aab4989e6ed8caf8.jpg"></p>
<!--kg-card-end: markdown-->

<p>餐厅拐角处的一棵树.树的右边是一个大花坛(图中没有),想当年’老邱’(学生处主任,武警出身)在这整过两个带刀外校学生.</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/2/65/9efc435ba32a20daf5be39e4e7230.jpg"></p>
<!--kg-card-end: markdown-->

<p>教学楼,宿舍楼东边的一条路,灯是后来装的</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/4/54/da0017701197c7e5b1e0b9a8c0a39.jpg"></p>
<!--kg-card-end: markdown-->

<p>对了,我们那一级是16个班,然而其他初中就算全校也没有16个班啊有木有,所以我们会说’拉我们一个级部出去可以打其他学校的整个学校’.不过后来招的学生就慢慢变少了,我们下一级好像是14个班.这几年好像8个班…</p>
<h3 id="平度市开发区高中"><a href="#平度市开发区高中" class="headerlink" title="平度市开发区高中"></a>平度市开发区高中</h3><p>高中跟初中比起来就比较老旧了,因为初中是06年刚搬到新校区.而高中一直是这个校区.然而一中,九中都换了新校区,并且其他几所高中由于跟一中九中合并,同样也是新校区,就我们学校.万恶的资本主义,唉.</p>
<p>仁卿楼,主教学楼,楼前一本大书,内容是<code>劝学</code>(劝学是个什么鬼,劝你退学,恩!),左边是中文版,右边是英文版</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/9/28/bdbad9b58ca6f2582e8293dbff073.jpg"><br> <img alt data-src="https://pic.jingxuetao.com/image/b/1c/dba6ba975e532af568308e9920a46.jpg"></p>
<!--kg-card-end: markdown-->

<p>仁卿楼广场西边,餐厅南边的小花坛,再往西是高二西教学楼</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/e/59/702c36e0445227fd6fa57dbe2f358.jpg"></p>
<!--kg-card-end: markdown-->

<p>高二西教学楼前的草坪,想起了被班主任没收的手机…</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/7/0b/c62bb75aac26bffd5c4624f4f8860.jpg"></p>
<!--kg-card-end: markdown-->

<p>高二西教学楼前的走廊</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/a/f5/fcc685c478b3bb72a9f2d79266fd6.jpg"></p>
<!--kg-card-end: markdown-->

<p>仁卿楼广场西面的办公楼,高三临近毕业的时候正式入团(共青团)就是在这弄得^_^,少交了好几年团费,不亏.</p>
<!--kg-card-begin: markdown-->

<p><img alt data-src="https://pic.jingxuetao.com/image/0/0b/01322c280b0c6dc8b089072d19bbc.jpg"></p>
<!--kg-card-end: markdown-->

<p>高中官网上的图片差不多就这些了,大一的时候高中又重修了一座教学楼跟操场,说好的重建校区呢??看来重建校区是没希望了..</p>
<p>有时间一定回去看看，但是什么时候有时间呢？这是个问题.</p>
<p>好了,矫情完毕,睡觉.</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>Me</category>
      </categories>
  </entry>
  <entry>
    <title>如何配置使用HSTS</title>
    <url>/configure-the-use-of-hsts/</url>
    <content><![CDATA[<p>HTTP严格传输安全（英语：HTTP Strict Transport Security，缩写：HSTS）是一套由互联网工程任务组发布的互联网安全策略机制。网站可以选择使用HSTS策略，来让浏览器强制使用HTTPS与网站进行通信，以减少会话劫持风险.</p>
<h3 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h3><p>HSTS的作用是强制客户端（如浏览器）使用HTTPS与服务器创建连接。服务器开启HSTS的方法是，当客户端通过HTTPS发出请求时，在服务器返回的超文本传输协议响应头中包含Strict-Transport-Security字段。非加密传输时设置的HSTS字段无效。</p>
<p>比如，<a href="https://example.com/" target="_blank" rel="noopener">https://example.com/</a> 的响应头含有Strict-Transport-Security: max-age=31536000; includeSubDomains。这意味着两点：</p>
<ol>
<li>在接下来的一年（即31536000秒）中，浏览器只要向example.com或其子域名发送HTTP请求时，必须采用HTTPS来发起连接。比如，用户点击超链接或在地址栏输入<a href="http://www.example.com/" target="_blank" rel="noopener">http://www.example.com/</a> ，浏览器应当自动将 http 转写成 https，然后直接向 <a href="https://www.example.com/" target="_blank" rel="noopener">https://www.example.com/</a> 发送请求。</li>
<li>在接下来的一年中，如果 example.com 服务器发送的TLS证书无效，用户不能忽略浏览器警告继续访问网站.</li>
</ol>
<h3 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h3><p>HSTS的雏形来自于2008年4月在北京召开的第十七届国际万维网大会上柯林·杰克逊（Collin Jackson）和亚当·巴斯（Adam Barth）的题为“ForceHTTPS: Protecting High-Security Web Sites from Network Attacks”的演讲。他们的提议是使用“ForceHTTPS” Cookie来强制浏览器使用HTTPS。</p>
<p>2009年9月18日，他们和杰夫·霍奇斯（Jeff Hodges）发布了最初的草案，题目为”Strict Transport Security”[5]，这个草案基于ForceHTTPS，并有所修改。</p>
<p>2010年6月17日，这三位作者经由互联网工程任务组发布了首版互联网草案，”HTTP Strict Transport Security”。</p>
<p>2012年10月2日，互联网工程指导组批准了将第14版HSTS草案发布为RFC的请求。</p>
<p>2012年11月19日，互联网工程任务组发布RFC 6797</p>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>HSTS可以用来抵御SSL剥离攻击。SSL剥离攻击是中间人攻击的一种，由Moxie Marlinspike于2009年发明。他在当年的黑帽大会上发表的题为“New Tricks For Defeating SSL In Practice”的演讲中将这种攻击方式公开。SSL剥离的实施方法是阻止浏览器与服务器创建HTTPS连接。它的前提是用户很少直接在地址栏输入 https:// ，用户总是通过点击链接或3xx重定向，从HTTP页面进入HTTPS页面。所以攻击者可以在用户访问HTTP页面时替换所有 https:// 开头的链接为 http:// ，达到阻止HTTPS的目的.</p>
<p>HSTS可以很大程度上解决SSL剥离攻击，因为只要浏览器曾经与服务器创建过一次安全连接，之后浏览器会强制使用HTTPS，即使链接被换成了HTTP。</p>
<p>另外，如果中间人使用自己的自签名证书来进行攻击，浏览器会给出警告，但是许多用户会忽略警告。HSTS解决了这一问题，一旦服务器发送了HSTS字段，用户将不再允许忽略警告。</p>
<h3 id="不足"><a href="#不足" class="headerlink" title="不足"></a>不足</h3><p>用户首次访问某网站是不受HSTS保护的。这是因为首次访问时，浏览器还未收到HSTS，所以仍有可能通过明文HTTP来访问。解决这个不足目前有两种方案，一是浏览器预置HSTS域名列表，Google Chrome、Firefox、Internet Explorer和Microsoft Edge实现了这一方案。二是将HSTS信息加入到域名系统记录中。但这需要保证DNS的安全性，也就是需要部署域名系统安全扩展。截至2014年这一方案没有大规模部署。</p>
<p>由于HSTS会在一定时间后失效（有效期由max-age指定），所以浏览器是否强制HSTS策略取决于当前系统时间。部分操作系统经常通过网络时间协议更新系统时间，如Ubuntu每次连接网络时，OS X Lion每隔9分钟会自动连接时间服务器。攻击者可以通过伪造NTP信息，设置错误时间来绕过HSTS。解决方法是认证NTP信息，或者禁止NTP大幅度增减时间。比如Windows 8每7天更新一次时间，并且要求每次NTP设置的时间与当前时间不得超过15小时。</p>
<h3 id="浏览器支持"><a href="#浏览器支持" class="headerlink" title="浏览器支持"></a>浏览器支持</h3><ul>
<li>Chromium和Google Chrome从4.0.211.0版本开始支持HSTS</li>
<li>Firefox 4及以上版本</li>
<li>Opera 12及以上版本</li>
<li>Safari从OS X Mavericks起</li>
<li>Internet Explorer从Windows 10技术预览版开始支持</li>
</ul>
<h3 id="网站支持"><a href="#网站支持" class="headerlink" title="网站支持"></a>网站支持</h3><p>根据SSL Pulse的调查，截至2015年2月，仅有2.7%的网站开启了HSTS。目前支持HSTS的主流网站有：支付宝、PayPal、Twitter、维基百科邮件列表、上善若水等。</p>
<blockquote>
<p>以上内容来自<a href="https://zh.wikipedia.org/wiki/HTTP%E4%B8%A5%E6%A0%BC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8" target="_blank" rel="noopener">维基百科</a>,维基百科真是个好网站.</p>
</blockquote>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>啰嗦了这么多,其实就是为了凑字数.Nginx配置在ssl.conf文件中的server字段下添加如下代码:</p>
<!--kg-card-begin: code-->

<pre><code>add_header Strict-Transport-Security &quot;max-age=31536000; includeSubdomains; preload&quot;;//第二个跟第三个参数一般来说没用,支付宝的首页就只用了第一个参数.所以添加下面一行配置就行
add_header Strict-Transport-Security &quot;max-age=31536000;&quot;;</code></pre><!--kg-card-end: code-->

<p><strong>max-age</strong> ，单位是秒，用来告诉浏览器在指定时间内，这个网站必须通过 HTTPS 协议来访问。也就是对于这个网站的 HTTP 地址，浏览器需要先在本地替换为 HTTPS 之后再发送请求。</p>
<p><strong>includeSubDomains</strong> ，可选参数，如果指定这个参数，表明这个网站所有子域名也必须通过 HTTPS 协议来访问。</p>
<p><strong>preload</strong> ,将域名加入HSTS Preload List,但是有这个参数也不一定能加入.</p>
<p>HSTS 这个响应头只能用于 HTTPS 响应；网站必须使用默认的 443 端口；必须使用域名，不能是 IP。而且启用 HSTS 之后，一旦网站证书错误，用户无法选择忽略。</p>
<h3 id="配置生效"><a href="#配置生效" class="headerlink" title="配置生效"></a>配置生效</h3><p>最后打开 <strong>chrome://net-internals/#hsts</strong> ,在Query domain中输入自己的域名(不加http),搜索一下试试.往后,只要用户不清缓存,就会直接通过<a href="https://xxxx.com:443" target="_blank" rel="noopener">https://xxxx.com:443</a> 访问网站,而不是通过http重定向到https的方式了.</p>
<p><strong>–EOF–</strong></p>
]]></content>
      <categories>
        <category>NGINX</category>
      </categories>
  </entry>
  <entry>
    <title>CentOS安装Ghost博客并实现全站HTTPS</title>
    <url>/centosan-zhuang-ghostbo-ke-bing-shi-xian-quan-zhan-https/</url>
    <content><![CDATA[<h3 id="1-前期准备"><a href="#1-前期准备" class="headerlink" title="1.前期准备"></a>1.前期准备</h3><!--kg-card-begin: code-->

<pre><code>yum update //更新yum源
yum groupinstall &quot;Development Tools&quot; //安装开发工具包
yum install wget //安装wget下载工具</code></pre><!--kg-card-end: code-->
<h3 id="2-安装Nginx"><a href="#2-安装Nginx" class="headerlink" title="2.安装Nginx"></a>2.安装Nginx</h3><!--kg-card-begin: code-->

<pre><code>yum install nginx -y //安装nginx
service nginx start //开启nginx
chkconfig nginx on //设置开机自启动</code></pre><!--kg-card-end: code-->

<p>Nginx安装完成,现在用IP或者域名就可以访问你的服务器了.</p>
<p>使用Nginx配置反向代理,指向ghost博客的2368端口.</p>
<!--kg-card-begin: code-->

<pre><code>cd /etc/nginx/conf.d //cd到nginx目录
vim default.conf //打开default.conf文件</code></pre><!--kg-card-end: code-->

<p>在文件中写入一下内容:</p>
<!--kg-card-begin: code-->

<pre><code>server {  
    listen 80;
    server_name jingxuetao.com;
    location / {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $http_host;
        proxy_pass http://127.0.0.1:2368;
        proxy_set_header REMOTE-HOST $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}</code></pre><!--kg-card-end: code-->

<p>将上面的server_name 替换成自己的域名,保存退出,并重启Nginx.</p>
<!--kg-card-begin: code-->

<pre><code>service nginx restart</code></pre><!--kg-card-end: code-->
<h3 id="3-安装MySQL"><a href="#3-安装MySQL" class="headerlink" title="3.安装MySQL"></a>3.安装MySQL</h3><blockquote>
<p>Ghost集成了sqlite3数据库,如果不用MySQL,本步可以忽略.</p>
</blockquote>
<!--kg-card-begin: code-->

<pre><code>yum install mysql mysql-server //安装MySQL
service mysqld restart //启动数据库
chkconfig mysqld on //设置开机启动
mysql_secure_installation //开始配置数据库</code></pre><!--kg-card-end: code--><!--kg-card-begin: code-->

<pre><code>Set root password? [Y/n] //设置root密码 -- 根据个人需求  
anonymous users? [Y/n] //删除匿名用户 -- y  
Disallow root login remotely? [Y/n] //禁止root用户远程登录 --n
Remove test database and access to it? [Y/n] //删除默认的 test 数据库 --y  
Reload privilege tables now? [Y/n] //是否马上应用最新的设置 --y  </code></pre><!--kg-card-end: code-->

<p>为了支持中文,还需要修改MySQL字符支持.</p>
<!--kg-card-begin: code-->

<pre><code>vim /etc/my.cnf</code></pre><!--kg-card-end: code-->

<p>在对应位置填入对应的内容:</p>
<!--kg-card-begin: code-->

<pre><code>[client]
default-character-set=utf8  
[mysql]
default-character-set=utf8  
[mysqld]
character-set-server=utf8  
collation-server=utf8_general_ci  </code></pre><!--kg-card-end: code-->

<p>然后新建一个Ghost专用MySQL用户跟database:</p>
<!--kg-card-begin: code-->

<pre><code>mysql -u root -p  
//用root用户登录mysql

create database ghost;  
//创建ghost数据库

GRANT ALL PRIVILEGES ON ghost.* To &apos;ghost&apos;@&apos;%&apos; IDENTIFIED BY &apos;密码&apos;;  
//创建ghost database 和 用户名为ghost的用户
//%代表能被所有地址访问</code></pre><!--kg-card-end: code-->
<h3 id="4-安装Node-js"><a href="#4-安装Node-js" class="headerlink" title="4.安装Node.js"></a>4.安装Node.js</h3><p>根据Ghost官方建议,安装v0.10.40版本</p>
<!--kg-card-begin: code-->

<pre><code>wget http://nodejs.org/dist/v0.10.40/node-v0.10.40.tar.gz
tar zxvf node-v0.10.40.tar.gz
cd node-v0.10.40
./configure
make &amp;&amp; make install</code></pre><!--kg-card-end: code-->
<h3 id="5-安装Ghost"><a href="#5-安装Ghost" class="headerlink" title="5.安装Ghost"></a>5.安装Ghost</h3><!--kg-card-begin: code-->

<pre><code>mkdir /var/www //创建Ghost安装路径
wget http://dl.ghostchina.com/Ghost-0.7.4-zh-full.zip //下载Ghost(中文版)
unzip Ghost-0.7.4-zh-full.zip //解压zip文件到当前文件夹
mv config.example.js config.js //重命名,并配置
vim config.js //打开config.js文件,并在里面填写对应内容.如果用sqlite3,只需要配置url</code></pre><!--kg-card-end: code--><!--kg-card-begin: code-->

<pre><code>production: {  
    url: &apos;http://jingxuetao.com&apos;, //这里是你自己VPS主机的域名，或者IP
    mail: {},
    database: {
        client: &apos;mysql&apos;这里我选择使用mysql作为我博客的数据库
        connection: {
            host : &apos;127.0.0.1&apos;,
            user : &apos;ghost&apos;, //mysql用户名
            password : &apos;&apos;, //密码
            database : &apos;ghost&apos;, //之前创建的ghost数据库名称
            charset : &apos;utf8&apos;
        },
    server: {
            host: &apos;127.0.0.1&apos;,
            port: &apos;2368&apos;//若修改该端口记得在nginx中做相应改变
        }
    }  </code></pre><!--kg-card-end: code-->

<p>现在在www目录下用命令npm start启动Ghost,网页就可以浏览了.</p>
<h3 id="6-使用PM2让Ghost永远在线"><a href="#6-使用PM2让Ghost永远在线" class="headerlink" title="6.使用PM2让Ghost永远在线"></a>6.使用PM2让Ghost永远在线</h3><p>只要我们一断开ssh，Ghost的进程就会被关闭，这里我们使用PM2来守护Ghost服务进程，并让其运行在生产模式production上</p>
<!--kg-card-begin: code-->

<pre><code>//！！首先进到ghost的安装目录
//安装pm2
npm install pm2 -g  
//让ghost以production模式运作，指定程序的入口index.js，并且此进程命名为ghost
NODE_ENV=production pm2 start index.js --name &quot;ghost&quot;  
//开机启动
pm2 startup centos  
pm2 save  </code></pre><!--kg-card-end: code-->

<p>进程守护做完，顺便提提pm2重启进程的命令是:</p>
<!--kg-card-begin: code-->

<pre><code>pm2 restart ghost</code></pre><!--kg-card-end: code-->

<p>用<a href="http://jingxuetao.com/ghost">http://jingxuetao.com/ghost</a> 访问后台</p>
<h3 id="7-设置外部存储"><a href="#7-设置外部存储" class="headerlink" title="7.设置外部存储"></a>7.设置外部存储</h3><p>Ghost默认是将图片存储在服务器上的,但是服务器存储空间有限,并且外部存储又不花钱.</p>
<p><a href="https://portal.qiniu.com/" target="_blank" rel="noopener">https://portal.qiniu.com/</a> 创建七牛云存储账号,并创建一个空间(公开空间).(使用免费空间之前得冲10块钱),然后修改Ghost配置文件如下:</p>
<!--kg-card-begin: code-->

<pre><code>/*storage: {
     provider: &apos;local-file-store&apos;
 }*/ //注释掉本地存储代码.
 storage: {
     provider: &apos;qiniu&apos;,
     bucketname: &apos;blog-pic&apos;,//空间名称
     ACCESS_KEY: &apos;d05f31DxWMuCdnqxxxxHOFc5cMJ4rQbdpnPJGB4F&apos;,//账号-&gt;密钥(左边菜单栏),将AK,SK分别对应ACCESS_KEY,SECRET_KEY填入
     SECRET_KEY: &apos;q6l8YgfxOdxGSR8U5_DwBhtyC5133xurgBGyjIHt&apos;,
     root: &apos;/image/&apos;,
     prefix: &apos;http://o3pxzuakz.qnssl.com&apos;//选择一个空间-&gt;空间设置-&gt;域名设置-&gt;七牛域名,将网址复制到这.
 }</code></pre><!--kg-card-end: code-->

<p>然后,在default.conf文件的location中添加</p>
<!--kg-card-begin: code-->

<pre><code>client_max_body_size 5m; //设置上传图片最大是5M,不设置上传图片会不成功,默认上传图片大小比较小.</code></pre><!--kg-card-end: code-->

<p>重启Ghost,上传一张图片试试,看看图片地址.</p>
<h3 id="8-设置HTTPS"><a href="#8-设置HTTPS" class="headerlink" title="8.设置HTTPS"></a>8.设置HTTPS</h3><p>①申请沃通免费证书,参考这篇文章.<br><a href="http://www.freehao123.com/cloudflare-wosign-ssl/" target="_blank" rel="noopener">Wosign沃通免费SSL申请开通</a></p>
<p>②选择nginx的证书,改名为cert.crt跟cert.key</p>
<p>③将证书上传到服务器的/etc/nginx目录下,然后配置Nginx.在/etc/nginx/conf.d目录下,除了default.conf文件之外,应该还有一个sslxxxxx.conf文件(没有就创建ssl.conf文件),将下面内容对比填入或者复制进去.</p>
<!--kg-card-begin: code-->

<pre><code># HTTPS server
#
server {
    listen 443 ssl;
    server_name jingxuetao.com;

    ssl_certificate /etc/nginx/cert.crt;
    ssl_certificate_key /etc/nginx/cert.key;

    ssl_session_cache shared:SSL:1m;
    ssl_session_timeout 5m;

    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    location / {
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://127.0.0.1:2368;
        client_max_body_size 5m;
    }
}</code></pre><!--kg-card-end: code-->

<p><strong>另外还得在config.js文件中将url字段http后面加个s,例如:</strong></p>
<!--kg-card-begin: code-->

<pre><code>url: &apos;https://jingxuetao.com&apos;</code></pre><!--kg-card-end: code-->

<p>现在通过<a href="https://jingxuetao.com">https://jingxuetao.com</a> 就可以访问自己的网站了.</p>
<p>要想将HTTP请求自动跳转到HTTPS,在default.conf文件的location中添加下面内容</p>
<!--kg-card-begin: code-->

<pre><code>return 301 https://$server_name$request_uri;</code></pre><!--kg-card-end: code-->

<p>现在是实现HTTPS了,但是因为网页中含有其他网站的资源文件(图片,一个是头像,另一个就是后台左上角的那个小图标,再就是自己上传到七牛的图片.),所以现在浏览器地址栏中并没有显示安全连接.</p>
<p>往后需要各种注意的细节,文字描述不清楚.不说了,心好累.</p>
<p>博客本来访问量就不多,耐心看到这的就更少了.如果需要,加我QQ吧,1247846317 验证问题:荆学涛.</p>
<p>END</p>
]]></content>
      <categories>
        <category>Ghost</category>
      </categories>
  </entry>
  <entry>
    <title>iOS界面跳转隐藏tabBar</title>
    <url>/ios-jump-hide-tabbar/</url>
    <content><![CDATA[<h3 id="一-IOS隐藏tabBar的方法"><a href="#一-IOS隐藏tabBar的方法" class="headerlink" title="一.IOS隐藏tabBar的方法:"></a>一.IOS隐藏tabBar的方法:</h3><!--kg-card-begin: code-->

<pre><code>self.tabBarController.tabBar.hidden = YES;</code></pre><!--kg-card-end: code-->

<p>但是我们跳转隐藏tabBar需要的不是这段代码.</p>
<h3 id="二-push跳转隐藏tabBar"><a href="#二-push跳转隐藏tabBar" class="headerlink" title="二.push跳转隐藏tabBar"></a>二.push跳转隐藏tabBar</h3><p>如果在push跳转时需要隐藏tabBar，设置self.hidesBottomBarWhenPushed=YES;并在push后设置self.hidesBottomBarWhenPushed=NO;这样back回来的时候，tabBar会恢复正常显示。代码如下:</p>
<!--kg-card-begin: code-->

<pre><code>NextViewController *next=[[NextViewController alloc]init];
next. hidesBottomBarWhenPushed = YES;
[self.navigationController pushViewController:next animated:YES];</code></pre><!--kg-card-end: code-->

<p>END</p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>一台虚拟机的悲哀</title>
    <url>/sorrow-of-a-virtual-machine/</url>
    <content><![CDATA[<blockquote>
<p>“哈哈,我终于从镜像文件变成变成操作系统啦,O(∩_∩)O~,我的主人每天都会用我办公超过10个小时.虽然我的身体素质不好,但是我有一颗顽强灵魂;虽然每天都会很累,但是我很开心.因为我是主人的操作系统呀!(<em>^_\</em>^<em>)”.<br>______________________________________________________________\</em>—–一台虚拟机的悲哀</p>
</blockquote>
<!--kg-card-begin: code-->

<pre><code>或许我们也是虚拟机.</code></pre><!--kg-card-end: code-->
<ul>
<li>博客从ACE转移到ECS上了.过程比较曲折,结果还算完美.</li>
<li>明天写一下教程,然后再把HTTPS的反代理弄一下.又得翻代码.</li>
<li>以后不折腾了,不折腾了.</li>
</ul>
<p>END</p>
]]></content>
      <categories>
        <category>Me</category>
      </categories>
  </entry>
  <entry>
    <title>通过runtime让属性在category上飞</title>
    <url>/by-runtime-to-allow-properties-to-fly-on-category/</url>
    <content><![CDATA[<h3 id="现在面临的场景"><a href="#现在面临的场景" class="headerlink" title="现在面临的场景"></a>现在面临的场景</h3><p>在做项目过程中难免会创建很多ViewModel,这些ViewModel难免有些共同的方法跟属性,这些共同的方法和属性可以单独提取出来,这就用到category.我现在的具体场景是:每个ViewModel都需要请求数据,当ViewController从当前界面切换到另一个画面时,暂停本页面的网络请求.</p>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p>NSObject+ViewModel.h文件</p>
<!--kg-card-begin: code-->

<pre><code>@interface NSObject (ViewModel)
@property (nonatomic) NSURLSessionDataTask *dataTask;
- (void)cancelTask; //取消任务
- (void)suspendTask; //暂停任务
- (void)resumeTask; //继续任务
@end</code></pre><!--kg-card-end: code-->

<p>NSObject+ViewModel.m文件</p>
<!--kg-card-begin: code-->

<pre><code>#import &quot;NSObject+ViewModel.h&quot;
#import &lt;objc/runtime.h&gt;//得引入runtime

static const void *dataTaskKey = &amp;dataTaskKey;
@implementation NSObject (ViewModel)

//通过运行时, 实现setter方法动态的绑定属性到对象
/**
  参数一 源对象,此处是self
  参数二 唯一静态变量,dataTaskKey保存的是他自己的地址,因为是静态的,所以地址不会重复
  参数三 关联的对象
  参数四 关联策略(属性的内存管理方式),关联策略详细解释在下面
**/
- (void)setDataTask:(NSURLSessionDataTask *)dataTask{
    objc_setAssociatedObject(self, dataTaskKey, dataTask, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

/**
  参数一 源对象,此处是self
  参数二 唯一静态变量,dataTaskKey保存的是他自己的地址,因为是静态的,所以地址不会重复
**/
- (NSURLSessionDataTask *)dataTask{
    return objc_getAssociatedObject(self, dataTaskKey);
}

- (void)resumeTask{
    [self.dataTask resume];
}
- (void)cancelTask{
    [self.dataTask cancel];
}
- (void)suspendTask{
    [self.dataTask suspend];
}
@end</code></pre><!--kg-card-end: code-->
<h3 id="关联策略"><a href="#关联策略" class="headerlink" title="关联策略"></a>关联策略</h3><p>&nbsp; &nbsp; &nbsp;Behavior &nbsp; &nbsp;@property Equivalent &nbsp; &nbsp;Description &nbsp; &nbsp; &nbsp; &nbsp;OBJC_ASSOCIATION_ASSIGN &nbsp; &nbsp;@property (assign) 或 @property (unsafe_unretained) &nbsp; &nbsp;指定一个关联对象的弱引用。 &nbsp; &nbsp; &nbsp; &nbsp;OBJC_ASSOCIATION_RETAIN_NONATOMIC &nbsp; &nbsp;@property (nonatomic, strong) &nbsp; &nbsp;指定一个关联对象的强引用，不能被原子化使用。 &nbsp; &nbsp; &nbsp; &nbsp;OBJC_ASSOCIATION_COPY_NONATOMIC &nbsp; &nbsp;@property (nonatomic, copy) &nbsp; &nbsp;指定一个关联对象的copy引用，不能被原子化使用。 &nbsp; &nbsp; &nbsp; &nbsp;OBJC_ASSOCIATION_RETAIN &nbsp; &nbsp;@property (atomic, strong) &nbsp; &nbsp;指定一个关联对象的强引用，能被原子化使用。 &nbsp; &nbsp; &nbsp; &nbsp;OBJC_ASSOCIATION_COPY &nbsp; &nbsp;@property (atomic, copy) &nbsp; &nbsp;指定一个关联对象的copy引用，能被原子化使用。 &nbsp;</p>
<blockquote>
<p>这两个方法可以让一个对象和另一个对象关联，就是说一个对象可以保持对另一个对象的引用，并获取那个对象。有了这些，就能实现属性功能了。</p>
</blockquote>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
  <entry>
    <title>全站实现HTTPS访问</title>
    <url>/implementation-of-https-access-station/</url>
    <content><![CDATA[<p>经过一番折腾,现在博客能通过HTTPS访问了,但是还不完美,主要是图片资源不是通过HTTPS形式访问的.一个是自己上传的图片,这个好解决,修改一下七牛上传的图片地址就行.另一个就是多说的头像,多说的头像不支持HTTPS,这个得通过反代理的形式.不知道ACE支不支持反代理,已经提交了工单.当然自己上传的图片也可以通过反代理的形式.</p>
<p>年轻就是折腾!</p>
<p>END</p>
]]></content>
      <categories>
        <category>Me</category>
      </categories>
  </entry>
  <entry>
    <title>又转到了ghost博客</title>
    <url>/went-to-ghost-2/</url>
    <content><![CDATA[<p>用了有半年多的b3log solo博客程序,虽然solo的博客编辑用的也是markdown格式的,但是个人感觉好难用.尽管我发表写的博文并不多.但是有点完美主义的我(并不是往自己身上贴标签),还是不愿意再用solo了.我会把<a href="http://www.jingxuetao.com指向原来的IP,原来的程序有几十篇博文,转移起来也好麻烦,懒得动了.然后在导航设置一个链接,链接到原来的博客.呵,不知道以后会不会再换回WordPress.呵呵,我并不知道.以后的事以后再说吧" target="_blank" rel="noopener">www.jingxuetao.com指向原来的IP,原来的程序有几十篇博文,转移起来也好麻烦,懒得动了.然后在导航设置一个链接,链接到原来的博客.呵,不知道以后会不会再换回WordPress.呵呵,我并不知道.以后的事以后再说吧</a>.</p>
<p>现在感觉这个markdown格式用起来还是比较不错的.</p>
<!--kg-card-begin: code-->

<pre><code>public static void main(String args[]){
    System.out.println(&quot;hello world!!&quot;);
}</code></pre><!--kg-card-end: code-->

<p>现在代码插入也很方便,可能原来插入代码就很方便,只不过是因为心里问题,觉得原来好麻烦.</p>
<ol>
<li>现在</li>
<li>现在插入代码</li>
<li>现在插入代码很方便</li>
</ol>
<p>无序列表</p>
<ul>
<li>无序列表1</li>
<li>无序列表2</li>
</ul>
<p>还可以插入图片,插入图片也很方便</p>
<!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img class="kg-image" alt="这是一张即将要插入的图片" data-src="https://o3pxzuakz.qnssl.com/75b31e23e4e4c22e24daa3de4ed47474.jpeg/image/1/ef/849ba9f8cea329e8faaefa49aa970.jpg"></figure><!--kg-card-end: image--><!--kg-card-begin: code-->

<pre><code>public static void main(String args[]){
    //这是一个由```写的高亮代码
}</code></pre><!--kg-card-end: code-->

<p>添加引用:</p>
<blockquote>
<p>这是一个引用</p>
</blockquote>
<p>添加分割线</p>
<!--kg-card-begin: hr-->
<hr>
<!--kg-card-end: hr-->

<p>一些常用得markdown语法都在这了,用起来还算顺手.</p>
<p>上方配图来自<a href="http://weibo.com/bboyzong" target="_blank" rel="noopener">王源宗Bboy</a></p>
]]></content>
      <categories>
        <category>Me</category>
      </categories>
  </entry>
  <entry>
    <title>为Xib中的控件设置圆角</title>
    <url>/set-the-corner-for-the-control-in-xib/</url>
    <content><![CDATA[<p>今天同学问了我一个问题,Google了一下,以后会用到,所以在这记录一下.</p>
<p>有时候,项目需要引用XIB,但是有些UI属性在面板不好设置,例如设置圆角.那么我们可以采取一种思路,通过拖线连接到.m文件,然后开始进行代码属性的修改,但是切记.设置圆角的方法,不能在ViewDidLoad里边重写,这样会导致无效,我们需要在drawRect进行设置,然后再进行调用即可.代码如下:</p>
<!--kg-card-begin: code-->

<pre><code>- (void)drawRect:(CGRect)rect{

  [super drawRect:rect];

  self.imgView.layer.cornerRadius = 20;

  self.imgView.clipsToBounds =YES;

}</code></pre><!--kg-card-end: code-->

<p>另外,有道云笔记这个工具不错.</p>
<p>再就是推荐一个国外的非常不错的图库<a href="https://unsplash.com/" target="_blank" rel="noopener">Unsplash</a>,上面有很多高清图,可以免费使用.以后写博客,就从这上面盗图了.</p>
<p>END</p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
  </entry>
</search>
